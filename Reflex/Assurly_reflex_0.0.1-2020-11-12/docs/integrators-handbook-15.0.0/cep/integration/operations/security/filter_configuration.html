<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 at 2020-09-25 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20200925" />
    <meta http-equiv="Content-Language" content="en" />
    <title>ReFlex ReFlex Integrator's Handbook &#x2013; Filter configuration</title>
    <link rel="stylesheet" href="../../../../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../../../../css/site.css" />
    <link rel="stylesheet" href="../../../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../../../js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://www.hannover-re.com/" id="bannerLeft">
                                                                                                <img src="../../../../images/logo.svg"  alt="HannoverRe"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="https://www.hannover-re.com/" id="bannerRight">
                                                                                                <img src="../../../../images/hre-logo.svg"  alt="HannoverRe_log"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="projectVersion">Version: 15.0.0
                    </li>
              
              
                  <li id="publishDate" class="pull-right">Last Published: 2020-09-25</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                          
      <li>
  
                          <a href="../../../../index.html" title="Document Information">
          <span class="none"></span>
        Document Information</a>
            </li>
                                                                                                                                                            
      <li>
  
                          <a href="../../../../reflex-overview/index.html" title="ReFlex Overview">
          <span class="icon-chevron-right"></span>
        ReFlex Overview</a>
                  </li>
                
      <li>
  
                          <a href="../../../../installation-guide.html" title="Installation Guide">
          <span class="none"></span>
        Installation Guide</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../../../update-guide/index.html" title="Update Guide">
          <span class="icon-chevron-right"></span>
        Update Guide</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../../../use-cases/index.html" title="Use Cases">
          <span class="icon-chevron-right"></span>
        Use Cases</a>
                  </li>
                              <li class="nav-header">RAS documentation</li>
                              
      <li>
  
                          <a href="../../../../ras/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../../../ras/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                                      
      <li>
  
                          <a href="../../../../ras/general-notes/index.html" title="General Notes">
          <span class="icon-chevron-right"></span>
        General Notes</a>
                  </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="../../../../ras/rest-resources/index.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                                                                                                                                                                                                                                                      
      <li>
  
                          <a href="../../../../ras/usage-scenarios/index.html" title="Usage Scenarios">
          <span class="icon-chevron-right"></span>
        Usage Scenarios</a>
                  </li>
                                                                                                                                          
      <li>
  
                          <a href="../../../../ras/known-issues/index.html" title="Known Issues">
          <span class="icon-chevron-right"></span>
        Known Issues</a>
                  </li>
                              <li class="nav-header">CEP documentation</li>
                              
      <li>
  
                          <a href="../../../../cep/integration/integration_mechanism.html" title="Integration Mechanism">
          <span class="none"></span>
        Integration Mechanism</a>
            </li>
                                                                                                                                                                                          
      <li>
  
                          <a href="../../../../cep/integration/backend/index.html" title="Back End Integration">
          <span class="icon-chevron-right"></span>
        Back End Integration</a>
                  </li>
                                                                                                                                                                                                                        
      <li>
  
                          <a href="../../../../cep/integration/frontend/index.html" title="Front End Integration">
          <span class="icon-chevron-right"></span>
        Front End Integration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../../../cep/integration/features/index.html" title="Optional Features">
          <span class="icon-chevron-right"></span>
        Optional Features</a>
                  </li>
                                                                                                                                        
      <li>
  
                          <a href="../../../../cep/integration/operations/index.html" title="Operations">
          <span class="icon-chevron-down"></span>
        Operations</a>
                    <ul class="nav nav-list">
                                                                                
      <li>
  
                          <a href="../../../../cep/integration/operations/security/index.html" title="Security">
          <span class="icon-chevron-down"></span>
        Security</a>
                    <ul class="nav nav-list">
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>Filter Configuration</a>
          </li>
              </ul>
        </li>
                    
      <li>
  
                          <a href="../../../../cep/integration/operations/deployment.html" title="Deployment">
          <span class="none"></span>
        Deployment</a>
            </li>
                    
      <li>
  
                          <a href="../../../../cep/integration/operations/logging.html" title="Logging">
          <span class="none"></span>
        Logging</a>
            </li>
              </ul>
        </li>
                
      <li>
  
                          <a href="../../../../cep/integration/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">DCS documentation</li>
                              
      <li>
  
                          <a href="../../../../dcs/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                
      <li>
  
                          <a href="../../../../dcs/configuration.html" title="Configuration">
          <span class="none"></span>
        Configuration</a>
            </li>
                
      <li>
  
                          <a href="../../../../dcs/rest-api.html" title="REST API">
          <span class="none"></span>
        REST API</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../../../dcs/template-config/template-configuration.html" title="Template Configuration">
          <span class="icon-chevron-right"></span>
        Template Configuration</a>
                  </li>
                
      <li>
  
                          <a href="../../../../dcs/known-issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">RSP documentation</li>
                                                                                                                                                        
      <li>
  
                          <a href="../../../../rsp/integration/integration.html" title="Integration">
          <span class="icon-chevron-right"></span>
        Integration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../../../rsp/configuration/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                              <li class="nav-header">MI documentation</li>
                              
      <li>
  
                          <a href="../../../../mi/installation/app-queue.html" title="AppQueue Installation">
          <span class="none"></span>
        AppQueue Installation</a>
            </li>
                                                                                    
      <li>
  
                          <a href="../../../../mi/index.html" title="Data export">
          <span class="icon-chevron-right"></span>
        Data export</a>
                  </li>
                              <li class="nav-header">3PS documentation</li>
                              
      <li>
  
                          <a href="../../../../tps/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                                        
      <li>
  
                          <a href="../../../../tps/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../../../tps/api.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                              <li class="nav-header">UWB documentation</li>
                              
      <li>
  
                          <a href="../../../../uwb/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                  
      <li>
  
                          <a href="../../../../uwb/installation/index.html" title="Installation">
          <span class="icon-chevron-right"></span>
        Installation</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../../../uwb/configuration/application/index.html" title="Application Configuration">
          <span class="icon-chevron-right"></span>
        Application Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../../../uwb/configuration/office/index.html" title="Office Configuration">
          <span class="icon-chevron-right"></span>
        Office Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../../../uwb/features/index.html" title="Advanced Features">
          <span class="icon-chevron-right"></span>
        Advanced Features</a>
                  </li>
                                                                  
      <li>
  
                          <a href="../../../../uwb/operations/index.html" title="Operations">
          <span class="icon-chevron-right"></span>
        Operations</a>
                  </li>
                
      <li>
  
                          <a href="../../../../uwb/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">MIGRATION documentation</li>
                              
      <li>
  
                          <a href="../../../../migration/index.html" title="User Guide">
          <span class="none"></span>
        User Guide</a>
            </li>
                              <li class="nav-header">Appendix</li>
                              
      <li>
  
                          <a href="../../../../glossary.html" title="Glossary">
          <span class="none"></span>
        Glossary</a>
            </li>
                
      <li>
  
                          <a href="../../../../component-versions.html" title="Component Versions">
          <span class="none"></span>
        Component Versions</a>
            </li>
                                                                                                                                          
      <li>
  
                          <a href="../../../../release-migration-notes.html" title="Release And Migration Notes">
          <span class="icon-chevron-right"></span>
        Release And Migration Notes</a>
                  </li>
                
      <li>
  
                          <a href="../../../../changelog.html" title="Changelog">
          <span class="none"></span>
        Changelog</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../../../../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <section><section>
<h3><a name="Filter_configuration"></a>Filter configuration</h3>
<p>CEP uses a filtering mechanism to prevent the disclosure of internal information to the end user. Each application form that is sent to the client is filtered according to a set of filter rules. These rules are usually described in a Spring Expression Language (SPEL) file in the reflex configuration directory (<code>$REFLEX_CONFIG_ROOTDIR/cep-core/applicationDataFilterRules.spel</code>). The CEP ships with a <a href="../../backend/configuration/cep-filter.html#Filter_configuration">recommended default configuration</a>.</p>
<p>The DSL uses a Java builder API to provide functionality to transform and filter a JSON document in arbitrary ways. The DSL itself is documented in JavaDoc (see <code>com.hannoverre.reflex.cep.filter.json.dsl.JsonFilterDsl</code>).</p>
<p>In short, a valid filter configuration contains a list of filter rules. Each filter rule consists of a matching expression and a set of actions. A matching expression describes to which JSON nodes a rule applies. An action describes a transformation that will be applied to each matched node.</p>
<p>The filter mechanism is applied to each application form that is sent to a user-agent.</p><section>
<h4><a name="Configuration_examples"></a>Configuration examples</h4>
<p>This section contains several configuration examples that are strongly recommended to be used in a production environment.</p><section>
<h5><a name="Filter_results_and_provided_data"></a>Filter results and provided data</h5>
<p>The following rule matches the root elements <code>results</code>, <code>provided</code>, <code>calculated</code>, <code>assessmentFactors</code>, and RAS internal data and removes them from the application form. This rule is very important because it prevents leaking of internal risk assessment results.</p>

<div class="source">
<div class="source"><pre class="prettyprint">  on(
        or(
            path(&quot;results&quot;),
            path(&quot;provided&quot;),
            path(&quot;calculated&quot;),
            path(&quot;assessmentFactors&quot;),
            path(&quot;questionnaire.meta.ras&quot;),
            path(&quot;meta.cep.permissions&quot;),
            path(&quot;meta.ras.cedent&quot;),
            path(&quot;meta.ras.knowledgebase.cedent&quot;),
            path(&quot;questionnaire.meta.ras&quot;),
            path(&quot;links&quot;),
            path(&quot;completed&quot;),
            path(&quot;valid&quot;)
        )
    ).then(remove)
</pre></div></div>
</section><section>
<h5><a name="Hide_parts_of_the_question_tree"></a>Hide parts of the question tree</h5>
<p>The following rule removes question groups that are not assigned to the applicant and have no sub-questions.</p>

<div class="source">
<div class="source"><pre class="prettyprint">on(
    and(isObject,
      pathStartsWith(&quot;questionnaire.questions&quot;),
      pathEndsWith(&quot;questions&quot;),
      has(&quot;questions&quot;).not(),
      has(&quot;type&quot;, eq(&quot;label&quot;)).not(),
      or(
        and(
            and(has(&quot;assignedTo&quot;), has(&quot;assignedTo&quot;, eq(&quot;Applicant&quot;))),
            has(&quot;answerModification&quot;),
            has(&quot;answerModification&quot;, has(&quot;source&quot;, eq(&quot;anonymous:Applicant&quot;).not())),
            has(&quot;tags&quot;),
            has(&quot;tags&quot;, has(&quot;HideIfAnsweredByDifferentSource&quot;))
        ),
        and(
            and(has(&quot;assignedTo&quot;), has(&quot;assignedTo&quot;, eq(&quot;Applicant&quot;)).not()),
            or(has(&quot;tags&quot;).not(), has(&quot;tags&quot;, has(&quot;ShowEvenIfNotAssignedTo&quot;)).not())
        )
      )
    )
  ).then(remove),
</pre></div></div>

<p>The following rule transforms questions that are not assigned to the applicant but have sub-questions that <i>may</i> be assigned to an applicant into virtual questions that only contain their id&#x2019;s and its sub-questions.</p>

<div class="source">
<div class="source"><pre class="prettyprint">  on(
    and(isObject,
      pathStartsWith(&quot;questionnaire.questions&quot;),
      pathEndsWith(&quot;questions&quot;),
      has(&quot;questions&quot;),
      or(
        and(
            and(has(&quot;assignedTo&quot;), has(&quot;assignedTo&quot;, eq(&quot;Applicant&quot;))),
            has(&quot;answerModification&quot;),
            has(&quot;answerModification&quot;, has(&quot;source&quot;, eq(&quot;anonymous:Applicant&quot;).not())),
            has(&quot;tags&quot;),
            has(&quot;tags&quot;, has(&quot;HideIfAnsweredByDifferentSource&quot;))
        ),
        and(
            and(has(&quot;assignedTo&quot;), has(&quot;assignedTo&quot;, eq(&quot;Applicant&quot;)).not()),
            or(has(&quot;tags&quot;).not(), has(&quot;tags&quot;, has(&quot;ShowEvenIfNotAssignedTo&quot;)).not())
        )
      )
    )
  ).then(
    removeFieldWith(
      and(
        pathEndsWith(&quot;id&quot;).not(),
        pathEndsWith(&quot;questions&quot;).not()
      )
    ),
    setField(&quot;type&quot;, &quot;virtual&quot;)
  )
</pre></div></div>

<p>The following rule hides question groups that contain no sub-questions.</p>

<div class="source">
<div class="source"><pre class="prettyprint">on(
    and(isObject,
      pathStartsWith(&quot;questionnaire.questions&quot;),
      pathEndsWith(&quot;questions&quot;),
      has(&quot;questions&quot;).not(),
      has(&quot;type&quot;, eq(&quot;group&quot;))
    )
  ).then(remove)
</pre></div></div>

<p>Ths rule hides the &#x201c;links&#x201d; section from questions.</p>

<div class="source">
<div class="source"><pre class="prettyprint">on(
       and(
           pathStartsWith(&quot;questionnaire.questions&quot;),
           pathEndsWith(&quot;questions.links&quot;)
       )
    ).then(remove)
</pre></div></div>
</section><section>
<h5><a name="Hide_audit_trails"></a>Hide audit trails</h5>
<p>The following rule hides answer modifications from the client.</p>

<div class="source">
<div class="source"><pre class="prettyprint">  on(
    and(isObject,
      pathStartsWith(&quot;questionnaire.questions&quot;),
      pathEndsWith(&quot;questions&quot;)
    )
  ).then(removeField(&quot;answerModification&quot;))
</pre></div></div>
</section><section>
<h5><a name="Ignore_ShowEvenIfNotAssignedTo-Tag_if_user_is_the_applicant"></a>Ignore ShowEvenIfNotAssignedTo-Tag if user is the applicant</h5>

<div class="source">
<div class="source"><pre class="prettyprint">  on(
    and(
      isObject,
      pathStartsWith(&quot;questionnaire.questions&quot;),
      pathEndsWith(&quot;questions&quot;),
      and(
        has(&quot;assignedTo&quot;),
        has(&quot;assignedTo&quot;, eq(&quot;Applicant&quot;)),
        has(&quot;tags&quot;),
        has(&quot;tags&quot;, has(&quot;ShowEvenIfNotAssignedTo&quot;)))
    )
  ).then(removePath(&quot;tags.ShowEvenIfNotAssignedTo&quot;))
</pre></div></div>
</section><section>
<h5><a name="Hide_search_context"></a>Hide search context</h5>

<div class="source">
<div class="source"><pre class="prettyprint">on(
        and(isObject,
            pathStartsWith(&quot;questionnaire.questions&quot;),
            pathEndsWith(&quot;questions&quot;),
            has(&quot;searchContextQuestions&quot;, isArray)
        )
    ).then(
        setPath(&quot;meta.cep.requiresSearchContextQuestions&quot;, true),
        removeField(&quot;searchContextQuestions&quot;)
    )
</pre></div></div></section></section></section></section>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2020.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
