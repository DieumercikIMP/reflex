<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 at 2020-09-25 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20200925" />
    <meta http-equiv="Content-Language" content="en" />
    <title>ReFlex ReFlex Integrator's Handbook &#x2013; Template configuration</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://www.hannover-re.com/" id="bannerLeft">
                                                                                                <img src="../../images/logo.svg"  alt="HannoverRe"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="https://www.hannover-re.com/" id="bannerRight">
                                                                                                <img src="../../images/hre-logo.svg"  alt="HannoverRe_log"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="projectVersion">Version: 15.0.0
                    </li>
              
              
                  <li id="publishDate" class="pull-right">Last Published: 2020-09-25</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                          
      <li>
  
                          <a href="../../index.html" title="Document Information">
          <span class="none"></span>
        Document Information</a>
            </li>
                                                                                                                                                            
      <li>
  
                          <a href="../../reflex-overview/index.html" title="ReFlex Overview">
          <span class="icon-chevron-right"></span>
        ReFlex Overview</a>
                  </li>
                
      <li>
  
                          <a href="../../installation-guide.html" title="Installation Guide">
          <span class="none"></span>
        Installation Guide</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../update-guide/index.html" title="Update Guide">
          <span class="icon-chevron-right"></span>
        Update Guide</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../use-cases/index.html" title="Use Cases">
          <span class="icon-chevron-right"></span>
        Use Cases</a>
                  </li>
                              <li class="nav-header">RAS documentation</li>
                              
      <li>
  
                          <a href="../../ras/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../ras/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                                      
      <li>
  
                          <a href="../../ras/general-notes/index.html" title="General Notes">
          <span class="icon-chevron-right"></span>
        General Notes</a>
                  </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="../../ras/rest-resources/index.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                                                                                                                                                                                                                                                      
      <li>
  
                          <a href="../../ras/usage-scenarios/index.html" title="Usage Scenarios">
          <span class="icon-chevron-right"></span>
        Usage Scenarios</a>
                  </li>
                                                                                                                                          
      <li>
  
                          <a href="../../ras/known-issues/index.html" title="Known Issues">
          <span class="icon-chevron-right"></span>
        Known Issues</a>
                  </li>
                              <li class="nav-header">CEP documentation</li>
                              
      <li>
  
                          <a href="../../cep/integration/integration_mechanism.html" title="Integration Mechanism">
          <span class="none"></span>
        Integration Mechanism</a>
            </li>
                                                                                                                                                                                          
      <li>
  
                          <a href="../../cep/integration/backend/index.html" title="Back End Integration">
          <span class="icon-chevron-right"></span>
        Back End Integration</a>
                  </li>
                                                                                                                                                                                                                        
      <li>
  
                          <a href="../../cep/integration/frontend/index.html" title="Front End Integration">
          <span class="icon-chevron-right"></span>
        Front End Integration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../cep/integration/features/index.html" title="Optional Features">
          <span class="icon-chevron-right"></span>
        Optional Features</a>
                  </li>
                                                                                                                              
      <li>
  
                          <a href="../../cep/integration/operations/index.html" title="Operations">
          <span class="icon-chevron-right"></span>
        Operations</a>
                  </li>
                
      <li>
  
                          <a href="../../cep/integration/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">DCS documentation</li>
                              
      <li>
  
                          <a href="../../dcs/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                
      <li>
  
                          <a href="../../dcs/configuration.html" title="Configuration">
          <span class="none"></span>
        Configuration</a>
            </li>
                
      <li>
  
                          <a href="../../dcs/rest-api.html" title="REST API">
          <span class="none"></span>
        REST API</a>
            </li>
                                                                                                          
      <li class="active">
  
            <a href="#"><span class="icon-chevron-down"></span>Template Configuration</a>
                  <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../../dcs/template-config/xsl-fo-templates.html" title="XSL FO Templates">
          <span class="none"></span>
        XSL FO Templates</a>
            </li>
                    
      <li>
  
                          <a href="../../dcs/template-config/test-debug.html" title="Testing and Debugging">
          <span class="none"></span>
        Testing and Debugging</a>
            </li>
                    
      <li>
  
                          <a href="../../dcs/template-config/pipelineXSD.html" title="Pipeline Structure">
          <span class="none"></span>
        Pipeline Structure</a>
            </li>
              </ul>
        </li>
                
      <li>
  
                          <a href="../../dcs/known-issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">RSP documentation</li>
                                                                                                                                                        
      <li>
  
                          <a href="../../rsp/integration/integration.html" title="Integration">
          <span class="icon-chevron-right"></span>
        Integration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../rsp/configuration/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                              <li class="nav-header">MI documentation</li>
                              
      <li>
  
                          <a href="../../mi/installation/app-queue.html" title="AppQueue Installation">
          <span class="none"></span>
        AppQueue Installation</a>
            </li>
                                                                                    
      <li>
  
                          <a href="../../mi/index.html" title="Data export">
          <span class="icon-chevron-right"></span>
        Data export</a>
                  </li>
                              <li class="nav-header">3PS documentation</li>
                              
      <li>
  
                          <a href="../../tps/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                                        
      <li>
  
                          <a href="../../tps/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../tps/api.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                              <li class="nav-header">UWB documentation</li>
                              
      <li>
  
                          <a href="../../uwb/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                  
      <li>
  
                          <a href="../../uwb/installation/index.html" title="Installation">
          <span class="icon-chevron-right"></span>
        Installation</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../uwb/configuration/application/index.html" title="Application Configuration">
          <span class="icon-chevron-right"></span>
        Application Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../uwb/configuration/office/index.html" title="Office Configuration">
          <span class="icon-chevron-right"></span>
        Office Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../uwb/features/index.html" title="Advanced Features">
          <span class="icon-chevron-right"></span>
        Advanced Features</a>
                  </li>
                                                                  
      <li>
  
                          <a href="../../uwb/operations/index.html" title="Operations">
          <span class="icon-chevron-right"></span>
        Operations</a>
                  </li>
                
      <li>
  
                          <a href="../../uwb/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">MIGRATION documentation</li>
                              
      <li>
  
                          <a href="../../migration/index.html" title="User Guide">
          <span class="none"></span>
        User Guide</a>
            </li>
                              <li class="nav-header">Appendix</li>
                              
      <li>
  
                          <a href="../../glossary.html" title="Glossary">
          <span class="none"></span>
        Glossary</a>
            </li>
                
      <li>
  
                          <a href="../../component-versions.html" title="Component Versions">
          <span class="none"></span>
        Component Versions</a>
            </li>
                                                                                                                                          
      <li>
  
                          <a href="../../release-migration-notes.html" title="Release And Migration Notes">
          <span class="icon-chevron-right"></span>
        Release And Migration Notes</a>
                  </li>
                
      <li>
  
                          <a href="../../changelog.html" title="Changelog">
          <span class="none"></span>
        Changelog</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Template configuration</h1>
<p>Documents are created by the use of templates that have to be placed in the <code>&lt;reflex.config.dir&gt;/&lt;dcs.config.dir&gt;/doctypes</code> directory. Each template must be put into a directory that equals the template name and contain a <code>pipeline.xml</code> file that configures the document creation steps.</p><section>
<h2><a name="Sample_templates"></a>Sample templates</h2>
<p>The DCS configuration contains sample templates that can be used as a guideline to create your own templates.</p><section>
<h3><a name="PDF_sample_template"></a>PDF sample template</h3>
<p>The DCS configuration contains a sample template for PDF generation via FOP that is called <code>sample-application</code>.</p>
<p>The <i>Template</i> directory <code>&lt;reflex.config.dir&gt;/&lt;dcs.config.dir&gt;/doctypes/sample-application</code> contains the files for the <code>sample-application</code> template:</p>
<ul>

<li><code>i18n_ar.xml</code></li>
<li><code>i18n_de.xml</code></li>
<li><code>i18n_fr.xml</code></li>
<li><code>i18n_ja.xml</code></li>
<li><code>i18n_ko.xml</code></li>
<li><code>i18n_ru.xml</code></li>
<li><code>i18n_zh.xml</code></li>
<li><code>i18n.xml</code></li>
<li><code>pipeline.xml</code></li>
<li><code>intermediateXmlToFoXml.xslt</code></li>
<li><code>logo.svg</code></li>
</ul></section><section>
<h3><a name="Common_templates"></a>Common templates</h3>
<p>The template relies on a common transformation style sheet called <code>cspJsonXmlToIntermediateXml.xslt</code>. You can find this in the <code>&lt;reflex.config.dir&gt;/&lt;dcs.config.dir&gt;/common</code> directory. This directory can be used to hold templates that are commonly used among different templates.</p></section><section>
<h3><a name="Create_the_sample_documents_via_the_REST_API"></a>Create the sample documents via the REST API</h3>
<p>Sending a HTTP Post with a ReFlex application JSON to the following url:</p>
<ul>

<li><code>&lt;hostname&gt;/dcs/document?type=sample-application&amp;language=en</code></li>
</ul>
<p>will return a PDF as byte stream.</p>
<ul>

<li>the <b>type</b> parameter specifies the template to be used for the generation</li>
<li>the <b>language</b> parameter specifies the i18n file to be used for the generation</li>
</ul>
<p>The following post url will create HR LH XML results:</p>
<ul>

<li><code>&lt;hostname&gt;/dcs/document?type=hrlhxml&amp;language=en</code></li>
</ul>
<p>See <a href="../rest-api.html">REST Interface API</a> for more details.</p></section></section><section>
<h2><a name="Creating_custom_templates"></a>Creating custom templates</h2>
<p>Other templates can be created by creating template directories within the <code>&lt;reflex.config.dir&gt;/&lt;dcs.config.dir&gt;/doctypes/</code> directory and providing the <code>pipeline.xml</code>configuration file.</p></section><section>
<h2><a name="Document_creation_pipelines"></a>Document creation pipelines</h2>
<p>Each template must contain a <code>pipeline.xml</code> that configures the single steps needed to generate the document. The file must follow the <a class="externalLink" href="http://spring.io/docs">Spring</a> XML-based application context format. The structure of the pipeline element itself is defined in the <a href="pipelineXSD.html">Pipeline Schema definition</a> ) that comes with the DCS. <code>Note that the pipeline root element must have the same id as the template (folder name).</code></p>
<p>Example of a JSON to PDF creation pipeline:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
      xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
      xmlns:dcs=&quot;http://www.hannover-re.com/dcs/schema/pipeline&quot;
      xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                          http://www.hannover-re.com/dcs/schema/pipeline http://www.hannover-re.com/dcs/schema/pipeline/pipeline.xsd&quot;&gt;

   &lt;dcs:pipeline id=&quot;template-name&quot;&gt;
     &lt;dcs:jsonToXml/&gt;
     &lt;dcs:xslTransformation styleSheet=&quot;cspJsonXmlToIntermediateXml.xslt&quot;/&gt;
     &lt;dcs:i18NXmlProcessor/&gt;
     &lt;dcs:xslTransformation styleSheet=&quot;intermediateXmlToFoXml.xslt&quot;/&gt;
     &lt;dcs:fopProcessor mimeType=&quot;application/pdf&quot;/&gt;
   &lt;/dcs:pipeline&gt;
&lt;/beans&gt;
</pre></div></div>
<section>
<h3><a name="Pipeline_root_element"></a>Pipeline root element</h3>
<p>The pipeline root element must set an id attribute that matches the template name. The order of the child nodes defines the type of processors and processing order. The input mime type (e.g. application/json) depends on the input type of the first element of the pipeline, whereas the output mime type is determined by the output of the last element of the pipeline.</p>
<p>Because the output of each processor element is forwarded to the input of the following element, the output mime type must match the input mime type of the following element.</p>

<table border="0" class="table table-striped">
    
<tr class="a">
        
<td>Input Type</td>
<td>Input Type of first child processor</td>
    </tr>
    
<tr class="b">
        
<td>Output Type</td>
<td>Output Type of last child processor</td>
    </tr>
</table>
</section><section>
<h3><a name="JSON_to_XML_processor"></a>JSON to XML processor</h3>
<p>The <code>dcs:jsonToXML</code> processor does a generic transformation of the input json to xml. Note that the newly created root node will be the template name.</p>

<table border="0" class="table table-striped">
    
<tr class="a">
        
<td>Input Type</td>
<td>application/json</td>
    </tr>
    
<tr class="b">
        
<td>Output Type</td>
<td>application/xml</td>
    </tr>
</table>

<p><b>Please note:</b> To retrieve valid xml from transforming the json, elements in the json starting with a digit in their name are prefixed with an underscore in xml. So if you rely on such elements in a later processing steps keep in mind that some names of elements might have changed.<br />
Example:</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;data&quot;: {
        &quot;3ps-attachments&quot;: {
            &quot;name&quot;: &quot;IDCV&quot;,
            &quot;type&quot;: &quot;PDF&quot;,
            &quot;base64EncodedData&quot;: &quot;base64&quot;
        },
        &quot;3ps-raw&quot;: &quot;3ps-raw&quot;
    }
}
</pre></div></div>

<p>After converting this json to xml the result looks like this:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;?xml version=&quot;1.0&quot; ?&gt;
&lt;root&gt;
    &lt;data&gt;
        &lt;_3ps-attachments&gt;
            &lt;name&gt;IDCV&lt;/name&gt;
            &lt;type&gt;PDF&lt;/type&gt;
            &lt;base64EncodedData&gt;base64&lt;/base64EncodedData&gt;
        &lt;/_3ps-attachments&gt;
        &lt;_3ps-raw&gt;3ps-raw&lt;/_3ps-raw&gt;
    &lt;/data&gt;
&lt;/root&gt;
</pre></div></div>
</section><section>
<h3><a name="XSLT_processor"></a>XSLT processor</h3>
<p>The <code>dcs:xslTransformation</code> processor applies the configured XSL-stylesheet to the input and outputs the result. The style sheet will be loaded from the template directory. If it does not exist it will be loaded from the <code>common</code> config directory as described earlier in the <code>Common Templates</code> section.</p>

<table border="0" class="table table-striped">
    
<tr class="a">
        
<td>Input Type</td>
<td>application/xml</td>
    </tr>
    
<tr class="b">
        
<td>Output Type</td>
<td>application/xml</td>
    </tr>
    
<tr class="a">
        
<td>Attribute: styleSheet</td>
<td>The XSL-stylesheet to be used</td>
    </tr>
</table>
</section><section>
<h3><a name="i18n_XML_processor"></a>i18n XML processor</h3>
<p>The <code>dcs:i18NXmlProcessor</code> element loads the language file based on the <b>language</b> query parameter provided when creating a document via the <a href="../rest-api.html">REST API</a>. It is used to provide dynamic translation texts. The translation files are loaded from the template folder like <code>i18n_&lt;lang&gt;.xml</code>. If the corresponding  language file does not exist, the default translation file <code>i18n.xml</code> will be loaded. The output produces XML that contains the loaded translation file and the input xml.</p>
<p>The transformed XML might look like the following example:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;template-namei18n&gt;
  &lt;!-- Here comes the input xml --&gt;
  &lt;input-xml-root&gt;
    ...
  &lt;/input-xml-root&gt;
  &lt;!-- Here comes the content from the loaded i18n&lt;lang&gt;.xml file --&gt;
  &lt;i18n language=&quot;languageKey&quot;&gt;
    &lt;text id=&quot;messageKey&quot;&gt;MessageText&lt;/text&gt;
    ...
  &lt;/i18n&gt;
&lt;/template-namei18n&gt;
</pre></div></div>

<table border="0" class="table table-striped">
    
<tr class="a">
        
<td>Input Type</td>
<td>application/xml</td>
    </tr>
    
<tr class="b">
        
<td>Output Type</td>
<td>application/xml</td>
    </tr>
</table>
</section><section>
<h3><a name="XSL_FO_templates"></a>XSL FO templates</h3>
<p>XSL-FO templates do not require an extra pipeline element since the <code>dcs:xslTransformation</code> can be used to apply a XSL-FO stylesheet. Since there are some remarks on XSL-FO templates, you can find more details <a href="xsl-fo-templates.html">here</a>.</p></section><section>
<h3><a name="FOP_processor"></a>FOP processor</h3>
<p>The <code>dcs:fopProcessor</code> is used to create variable documents from the input FO XML. Such input can be generated by using the <code>XSLT Processor</code> with a XSL-FO stylesheet that produces the required FO XML. The desired outputType is selected with the attribute <i>mimeType</i> which is mandatory for this processor.</p>
<p>Possible values can be retrieved from <i>org.apache.fop.apps.MimeConstants</i>. The following output types have been tested:</p>

<table border="0" class="table table-striped">
    
<tr class="a">
        
<th style="text-align: left;">Input Type</th>
        
<th style="text-align: left;">Mime Type</th>
        
<th style="text-align: left;">Output Format</th>
    </tr>
    
<tr class="b">
        
<td>application/xml</td>
        
<td>application/pdf</td>
        
<td>PDF</td>
    </tr>
        
<tr class="a">
        
<td>application/xml</td>
        
<td>application/rtf</td>
        
<td>RTF</td>
    </tr>
        
<tr class="b">
        
<td>application/xml</td>
        
<td>text/richtext</td>
        
<td>RTF</td>
    </tr>
        
<tr class="a">
        
<td>application/xml</td>
        
<td>text/rtf</td>
        
<td>RTF</td>
    </tr>
</table></section></section>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2020.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
