<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 at 2020-09-25 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20200925" />
    <meta http-equiv="Content-Language" content="en" />
    <title>ReFlex ReFlex Integrator's Handbook &#x2013; Context-aware assessment factor search</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://www.hannover-re.com/" id="bannerLeft">
                                                                                                <img src="../../images/logo.svg"  alt="HannoverRe"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="https://www.hannover-re.com/" id="bannerRight">
                                                                                                <img src="../../images/hre-logo.svg"  alt="HannoverRe_log"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="projectVersion">Version: 15.0.0
                    </li>
              
              
                  <li id="publishDate" class="pull-right">Last Published: 2020-09-25</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                          
      <li>
  
                          <a href="../../index.html" title="Document Information">
          <span class="none"></span>
        Document Information</a>
            </li>
                                                                                                                                                            
      <li>
  
                          <a href="../../reflex-overview/index.html" title="ReFlex Overview">
          <span class="icon-chevron-right"></span>
        ReFlex Overview</a>
                  </li>
                
      <li>
  
                          <a href="../../installation-guide.html" title="Installation Guide">
          <span class="none"></span>
        Installation Guide</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../update-guide/index.html" title="Update Guide">
          <span class="icon-chevron-right"></span>
        Update Guide</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../use-cases/index.html" title="Use Cases">
          <span class="icon-chevron-right"></span>
        Use Cases</a>
                  </li>
                              <li class="nav-header">RAS documentation</li>
                              
      <li>
  
                          <a href="../../ras/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../ras/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                                      
      <li>
  
                          <a href="../../ras/general-notes/index.html" title="General Notes">
          <span class="icon-chevron-right"></span>
        General Notes</a>
                  </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="../../ras/rest-resources/index.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                                                                                                                                                                                                                                                      
      <li>
  
                          <a href="../../ras/usage-scenarios/index.html" title="Usage Scenarios">
          <span class="icon-chevron-right"></span>
        Usage Scenarios</a>
                  </li>
                                                                                                                                                    
      <li>
  
                          <a href="../../ras/known-issues/index.html" title="Known Issues">
          <span class="icon-chevron-down"></span>
        Known Issues</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../../ras/known-issues/reflexiveon-handling.html" title="Handling of reflexiveOn">
          <span class="none"></span>
        Handling of reflexiveOn</a>
            </li>
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>Context-Aware Assessment Factor Search</a>
          </li>
                    
      <li>
  
                          <a href="../../ras/known-issues/partially-answered-structure-questions.html" title="Partially Answered Structure Questions">
          <span class="none"></span>
        Partially Answered Structure Questions</a>
            </li>
                    
      <li>
  
                          <a href="../../ras/known-issues/multiple-knowledgebases.html" title="Multiple Knowledge Bases">
          <span class="none"></span>
        Multiple Knowledge Bases</a>
            </li>
                    
      <li>
  
                          <a href="../../ras/known-issues/translating-risk-assessments.html" title="Translating risk assessments">
          <span class="none"></span>
        Translating risk assessments</a>
            </li>
              </ul>
        </li>
                              <li class="nav-header">CEP documentation</li>
                              
      <li>
  
                          <a href="../../cep/integration/integration_mechanism.html" title="Integration Mechanism">
          <span class="none"></span>
        Integration Mechanism</a>
            </li>
                                                                                                                                                                                          
      <li>
  
                          <a href="../../cep/integration/backend/index.html" title="Back End Integration">
          <span class="icon-chevron-right"></span>
        Back End Integration</a>
                  </li>
                                                                                                                                                                                                                        
      <li>
  
                          <a href="../../cep/integration/frontend/index.html" title="Front End Integration">
          <span class="icon-chevron-right"></span>
        Front End Integration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../cep/integration/features/index.html" title="Optional Features">
          <span class="icon-chevron-right"></span>
        Optional Features</a>
                  </li>
                                                                                                                              
      <li>
  
                          <a href="../../cep/integration/operations/index.html" title="Operations">
          <span class="icon-chevron-right"></span>
        Operations</a>
                  </li>
                
      <li>
  
                          <a href="../../cep/integration/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">DCS documentation</li>
                              
      <li>
  
                          <a href="../../dcs/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                
      <li>
  
                          <a href="../../dcs/configuration.html" title="Configuration">
          <span class="none"></span>
        Configuration</a>
            </li>
                
      <li>
  
                          <a href="../../dcs/rest-api.html" title="REST API">
          <span class="none"></span>
        REST API</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../dcs/template-config/template-configuration.html" title="Template Configuration">
          <span class="icon-chevron-right"></span>
        Template Configuration</a>
                  </li>
                
      <li>
  
                          <a href="../../dcs/known-issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">RSP documentation</li>
                                                                                                                                                        
      <li>
  
                          <a href="../../rsp/integration/integration.html" title="Integration">
          <span class="icon-chevron-right"></span>
        Integration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../rsp/configuration/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                              <li class="nav-header">MI documentation</li>
                              
      <li>
  
                          <a href="../../mi/installation/app-queue.html" title="AppQueue Installation">
          <span class="none"></span>
        AppQueue Installation</a>
            </li>
                                                                                    
      <li>
  
                          <a href="../../mi/index.html" title="Data export">
          <span class="icon-chevron-right"></span>
        Data export</a>
                  </li>
                              <li class="nav-header">3PS documentation</li>
                              
      <li>
  
                          <a href="../../tps/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                                        
      <li>
  
                          <a href="../../tps/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../tps/api.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                              <li class="nav-header">UWB documentation</li>
                              
      <li>
  
                          <a href="../../uwb/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                  
      <li>
  
                          <a href="../../uwb/installation/index.html" title="Installation">
          <span class="icon-chevron-right"></span>
        Installation</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../uwb/configuration/application/index.html" title="Application Configuration">
          <span class="icon-chevron-right"></span>
        Application Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../uwb/configuration/office/index.html" title="Office Configuration">
          <span class="icon-chevron-right"></span>
        Office Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../uwb/features/index.html" title="Advanced Features">
          <span class="icon-chevron-right"></span>
        Advanced Features</a>
                  </li>
                                                                  
      <li>
  
                          <a href="../../uwb/operations/index.html" title="Operations">
          <span class="icon-chevron-right"></span>
        Operations</a>
                  </li>
                
      <li>
  
                          <a href="../../uwb/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">MIGRATION documentation</li>
                              
      <li>
  
                          <a href="../../migration/index.html" title="User Guide">
          <span class="none"></span>
        User Guide</a>
            </li>
                              <li class="nav-header">Appendix</li>
                              
      <li>
  
                          <a href="../../glossary.html" title="Glossary">
          <span class="none"></span>
        Glossary</a>
            </li>
                
      <li>
  
                          <a href="../../component-versions.html" title="Component Versions">
          <span class="none"></span>
        Component Versions</a>
            </li>
                                                                                                                                          
      <li>
  
                          <a href="../../release-migration-notes.html" title="Release And Migration Notes">
          <span class="icon-chevron-right"></span>
        Release And Migration Notes</a>
                  </li>
                
      <li>
  
                          <a href="../../changelog.html" title="Changelog">
          <span class="none"></span>
        Changelog</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Context-aware assessment factor search</h1>
<p>The following issues regarding the context-aware assessment factor search currently exist. &#x201c;Context-aware&#x201d; means that in order to perform an assessment factor search for an assessment factor search question, additional answered questions are required that need to be passed to the search.</p>
<p>See also:</p>
<ul>

<li>Description of <a href="../media-types/assessment-factor-search-question.html#properties-searchContextQuestions"><code>searchContextQuestions</code> property</a> for media-type assessment factor search question.</li>
<li>Description of <a href="../rest-resources/assessmentfactors.html#assessmentfactors-GET"><code>questionnaire</code> query parameter</a> for REST resource assessment factors (GET)</li>
</ul>
<p><a name="issue-cas-03"></a></p><section>
<h2><a name="a.5BCAS-03.5D_Maximum_URI_length_exceeded"></a>[CAS-03] Maximum URI length exceeded</h2>
<p>In case the questionnaire provided to the <a href="../rest-resources/assessmentfactors.html#assessmentfactors-GET">assessment factor search</a> contains large amounts of data the URI might get too long for the web server to process. This will cause the search not being performed and the web server to respond with a status code of 414 (or 400 in some cases).</p>
<p><b>Workarounds</b>:<br />
a) <a href="#strategy-minimize-questionnaire">Minimize the questionnaire</a><br />
and/or b) <a href="#strategy-increase-max-uri-length">increase maximum URI length</a> in web server configuration.</p>
<p><a name="issue-cas-04"></a></p></section><section>
<h2><a name="a.5BCAS-04.5D_Inconsistent_answers_to_assessment_factor_search_questions"></a>[CAS-04] Inconsistent answers to assessment factor search questions</h2>
<p>If the <a href="../rest-resources/assessmentfactors.html#assessmentfactors-GET">assessment factor search</a> is used to <a href="../media-types/assessment-factor-search-question.html#properties-answer">answer</a> assessment factor search questions, it is possible that a search variable carries an inconsistent set of assessment factors as answer values. This can occur in cases where the answer given to one of the <a href="../media-types/assessment-factor-search-question.html#properties-searchContextQuestions">search context questions</a> gets changed after an assessment factor has been given as an answer to the search questions. In this case, the web server will respond with a status code of 500.</p>
<p><b>Workarounds</b>:<br />
a) Clients may track if an answer to a search context question has changed and then &#x201c;invalidate&#x201d; the answers given to all assessment factor search questions that require the changed search context question<br />
or b) <a href="#strategy-eliminate-ca-search-in-kb">eliminate context-aware search in knowledge base</a></p>
<p><a name="issue-cas-05"></a></p></section><section>
<h2><a name="a.5BCAS-05.5D_No_enforcement_of_search_context_questions_to_be_answered"></a>[CAS-05] No enforcement of search context questions to be answered</h2>
<p>There is no (automatic) enforcement of <a href="../media-types/assessment-factor-search-question.html#properties-searchContextQuestions">search context questions</a> having been answered before an <a href="../rest-resources/assessmentfactors.html#assessmentfactors-GET">assessment factor search</a> is performed for a <a href="../media-types/assessment-factor-search-question.html">search question</a> that requires one of the search context questions. In case of missing answers for search context questions, performing an assessment factor search will yield no results and therefore the search question cannot be answered. This behavior / dependency can be hardly understood by users - at least without providing appropriate hints.</p>
<p><b>Workarounds</b>:<br />
a) Clients may &#x201c;enable&#x201d; a search question (which requires search context questions) for being answerable only if answers to all context questions have been given - and &#x201c;disable&#x201d; a search question as soon as an answer to a context question is removed.<br />
or b) <a href="#strategy-eliminate-ca-search-in-kb">Eliminate context-aware search in knowledge base</a></p>
<p><a name="issue-cas-06"></a></p></section><section>
<h2><a name="a.5BCAS-06.5D_Ordering_of_assessment_factor_search_and_search_context_questions"></a>[CAS-06] Ordering of assessment factor search and search context questions</h2>
<p>There is no (automatic) enforcement that <a href="../media-types/assessment-factor-search-question.html#properties-searchContextQuestions">search context questions</a> are being &#x201c;asked&#x201d; before the <a href="../media-types/assessment-factor-search-question.html">search questions</a> that require them. This may be especially problematic in cases where a search context question is presented on a web page following the web page that a search question (which requires that context question) is presented on. In these cases the page containing the search question cannot be completed, since it can never be answered.</p>
<p><b>Workarounds</b>:<br />
a) The knowledge base designer must ensure the correct order of questions being asked, taking into account the filter statement of AssessmentFactorSearch variables. Further, the knowledge base designer must be aware of how questions are distributed onto pages (maybe even depending on different end-user devices)<br />
or b) <a href="#strategy-eliminate-ca-search-in-kb">eliminate context-aware search in knowledge base</a></p>
<p><a name="strategy-minimize-questionnaire"></a></p></section><section>
<h2><a name="Strategy:_Minimize_search_context_questionnaire"></a>Strategy: Minimize search context questionnaire</h2>
<p>In order to reduce the amount of data of the <code>questionnaire</code> query parameter passed to the <a href="../rest-resources/assessmentfactors.html#assessmentfactors-GET">assessment factor search</a>, clients can do the following:<br />
a) Use the <a href="../media-types/questionnaire.html#min">minimized information set</a> for the questionnaire.<br />
b) Include only those questions in the questionnaire that are required as <a href="../media-types/assessment-factor-search-question.html#properties-searchContextQuestions">search context questions</a>, along with the assessment factor search question itself.<br />
c) Remove whitespace characters from the questionnaire JSON.</p>
<p>This will resolve issue <a href="#issue-cas-03">[CAS-03]</a> in almost all cases. If these actions are not sufficient you need to <a href="#strategy-increase-max-uri-length">increase the maximum URI length</a> in the web server configuration.</p>
<p><a name="strategy-increase-max-uri-length"></a></p></section><section>
<h2><a name="Strategy:_Increase_maximum_URI_length"></a>Strategy: Increase maximum URI length</h2><section>
<h3><a name="Tomcat_8.x"></a>Tomcat 8.x</h3>
<p>In the <i>server.xml</i> configuration file add the <code>maxHttpHeaderSize</code> attribute to the <code>Connector</code> element and assign it an appropriate value. Note that the maximum value you can specify is <code>65536</code>.</p>
<p>Example:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot; maxHttpHeaderSize=&quot;65536&quot; ... /&gt;
</pre></div></div>
</section><section>
<h3><a name="Apache_2"></a>Apache 2</h3>
<p>In the <i>apache2.conf</i> configuration file add the <code>LimitRequestLine</code> parameter and set it to an appropriate value. Note that the maximum value you can specify is limited by the <code>DEFAULT_LIMIT_REQUEST_LINE</code> constant defined in the <i>httpd.h</i> header file inside of the Apache source code. In case this limit is too low, you must change the constant in the source code and re-compile Apache.</p>
<p>Example:</p>

<div class="source">
<div class="source"><pre class="prettyprint">LimitRequestLine 65536
</pre></div></div>
</section><section>
<h3><a name="Nginx"></a>Nginx</h3>
<p>In the <i>nginx.conf</i> configuration file set the values for the <code>large_client_header_buffers</code> directive to an appropriate value.</p>
<p>Example:</p>

<div class="source">
<div class="source"><pre class="prettyprint">large_client_header_buffers 4 64k;
</pre></div></div>

<p><a name="strategy-eliminate-ca-search-in-kb"></a></p></section></section><section>
<h2><a name="Strategy:_Eliminate_context-aware_search_in_knowledge_base"></a>Strategy: Eliminate context-aware search in knowledge base</h2>
<p>Definitions of <code>AssessmentFactorSearch</code> variables in a knowledge base having runtime-evaluated filter criteria can often be transformed so that they don&#x2019;t require context-aware searches. The basic idea is to duplicate those variables, thereby replacing the runtime-evaluated filter criteria with one that can be evaluated statically. Further, rules will be introduced that dispatch to the duplicated variables based on the value of some other variables (which used to be part of the runtime-evaluated filter criteria).</p>
<p>This will resolve the issues <a href="#issue-cas-04">[CAS-04]</a>, <a href="#issue-cas-05">[CAS-05]</a>, and <a href="#issue-cas-06">[CAS-06]</a>.</p>
<p>Given, for example, the following definitions in a knowledge base:</p>

<div class="source">
<div class="source"><pre class="prettyprint">require Diseases

&#x22ee;

AssessmentVariable Diseases {
    type AssessmentFactorSearch
    matches category==Medical and (tags.GenderOnly==InsuredPerson.Gender or not (tags contains GenderOnly))
}
</pre></div></div>

<p>The following definitions will eliminate the need to have context-aware searches:</p>

<div class="source">
<div class="source"><pre class="prettyprint">if InsuredPerson.Gender == GenderSelection.Male then require DiseasesMale
if InsuredPerson.Gender == GenderSelection.Female then require DiseasesFemale

&#x22ee;

AssessmentVariable DiseasesMale {
    type AssessmentFactorSearch
    matches category==Medical and (tags.GenderOnly==GenderSelection.Male or not (tags contains GenderOnly))
}

AssessmentVariable DiseasesFemale {
    type AssessmentFactorSearch
    matches category==Medical and (tags.GenderOnly==GenderSelection.Female or not (tags contains GenderOnly))
}
</pre></div></div></section>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2020.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
