<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 at 2020-09-25 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20200925" />
    <meta http-equiv="Content-Language" content="en" />
    <title>ReFlex ReFlex Integrator's Handbook &#x2013; Perform risk assessments</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://www.hannover-re.com/" id="bannerLeft">
                                                                                                <img src="../../images/logo.svg"  alt="HannoverRe"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="https://www.hannover-re.com/" id="bannerRight">
                                                                                                <img src="../../images/hre-logo.svg"  alt="HannoverRe_log"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="projectVersion">Version: 15.0.0
                    </li>
              
              
                  <li id="publishDate" class="pull-right">Last Published: 2020-09-25</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                          
      <li>
  
                          <a href="../../index.html" title="Document Information">
          <span class="none"></span>
        Document Information</a>
            </li>
                                                                                                                                                            
      <li>
  
                          <a href="../../reflex-overview/index.html" title="ReFlex Overview">
          <span class="icon-chevron-right"></span>
        ReFlex Overview</a>
                  </li>
                
      <li>
  
                          <a href="../../installation-guide.html" title="Installation Guide">
          <span class="none"></span>
        Installation Guide</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../update-guide/index.html" title="Update Guide">
          <span class="icon-chevron-right"></span>
        Update Guide</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../use-cases/index.html" title="Use Cases">
          <span class="icon-chevron-right"></span>
        Use Cases</a>
                  </li>
                              <li class="nav-header">RAS documentation</li>
                              
      <li>
  
                          <a href="../../ras/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../ras/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                                      
      <li>
  
                          <a href="../../ras/general-notes/index.html" title="General Notes">
          <span class="icon-chevron-right"></span>
        General Notes</a>
                  </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="../../ras/rest-resources/index.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                                                                                                                                                                                                                                                                
      <li>
  
                          <a href="../../ras/usage-scenarios/index.html" title="Usage Scenarios">
          <span class="icon-chevron-down"></span>
        Usage Scenarios</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../../ras/usage-scenarios/deploy-KB.html" title="Deploy a Knowledge Base">
          <span class="none"></span>
        Deploy a Knowledge Base</a>
            </li>
                    
      <li>
  
                          <a href="../../ras/usage-scenarios/undeploy-KB.html" title="Undeploy a Knowledge Base">
          <span class="none"></span>
        Undeploy a Knowledge Base</a>
            </li>
                    
      <li>
  
                          <a href="../../ras/usage-scenarios/list-products.html" title="List Products">
          <span class="none"></span>
        List Products</a>
            </li>
                    
      <li>
  
                          <a href="../../ras/usage-scenarios/assessmentfactorsearch.html" title="Assessment Factor Search">
          <span class="none"></span>
        Assessment Factor Search</a>
            </li>
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>Perform Risk Assessments</a>
          </li>
                    
      <li>
  
                          <a href="../../ras/usage-scenarios/translate-riskassessment.html" title="Translate Risk Assessment">
          <span class="none"></span>
        Translate Risk Assessment</a>
            </li>
                    
      <li>
  
                          <a href="../../ras/usage-scenarios/change-product-configuration.html" title="Change Product Configuration">
          <span class="none"></span>
        Change Product Configuration</a>
            </li>
                    
      <li>
  
                          <a href="../../ras/usage-scenarios/provide-external-data.html" title="Provide External Data">
          <span class="none"></span>
        Provide External Data</a>
            </li>
                    
      <li>
  
                          <a href="../../ras/usage-scenarios/update-provided-data.html" title="Update Externally Provided Data">
          <span class="none"></span>
        Update Externally Provided Data</a>
            </li>
                    
      <li>
  
                          <a href="../../ras/usage-scenarios/latest-knowledgebaseversion.html" title="Using the Latest Knowledge Base Version">
          <span class="none"></span>
        Using the Latest Knowledge Base Version</a>
            </li>
                    
      <li>
  
                          <a href="../../ras/usage-scenarios/next-unused-factor.html" title="Assessment Factor Search Question with Exposed Unused Factors">
          <span class="none"></span>
        Assessment Factor Search Question with Exposed Unused Factors</a>
            </li>
              </ul>
        </li>
                                                                                                                                          
      <li>
  
                          <a href="../../ras/known-issues/index.html" title="Known Issues">
          <span class="icon-chevron-right"></span>
        Known Issues</a>
                  </li>
                              <li class="nav-header">CEP documentation</li>
                              
      <li>
  
                          <a href="../../cep/integration/integration_mechanism.html" title="Integration Mechanism">
          <span class="none"></span>
        Integration Mechanism</a>
            </li>
                                                                                                                                                                                          
      <li>
  
                          <a href="../../cep/integration/backend/index.html" title="Back End Integration">
          <span class="icon-chevron-right"></span>
        Back End Integration</a>
                  </li>
                                                                                                                                                                                                                        
      <li>
  
                          <a href="../../cep/integration/frontend/index.html" title="Front End Integration">
          <span class="icon-chevron-right"></span>
        Front End Integration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../cep/integration/features/index.html" title="Optional Features">
          <span class="icon-chevron-right"></span>
        Optional Features</a>
                  </li>
                                                                                                                              
      <li>
  
                          <a href="../../cep/integration/operations/index.html" title="Operations">
          <span class="icon-chevron-right"></span>
        Operations</a>
                  </li>
                
      <li>
  
                          <a href="../../cep/integration/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">DCS documentation</li>
                              
      <li>
  
                          <a href="../../dcs/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                
      <li>
  
                          <a href="../../dcs/configuration.html" title="Configuration">
          <span class="none"></span>
        Configuration</a>
            </li>
                
      <li>
  
                          <a href="../../dcs/rest-api.html" title="REST API">
          <span class="none"></span>
        REST API</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../dcs/template-config/template-configuration.html" title="Template Configuration">
          <span class="icon-chevron-right"></span>
        Template Configuration</a>
                  </li>
                
      <li>
  
                          <a href="../../dcs/known-issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">RSP documentation</li>
                                                                                                                                                        
      <li>
  
                          <a href="../../rsp/integration/integration.html" title="Integration">
          <span class="icon-chevron-right"></span>
        Integration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../rsp/configuration/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                              <li class="nav-header">MI documentation</li>
                              
      <li>
  
                          <a href="../../mi/installation/app-queue.html" title="AppQueue Installation">
          <span class="none"></span>
        AppQueue Installation</a>
            </li>
                                                                                    
      <li>
  
                          <a href="../../mi/index.html" title="Data export">
          <span class="icon-chevron-right"></span>
        Data export</a>
                  </li>
                              <li class="nav-header">3PS documentation</li>
                              
      <li>
  
                          <a href="../../tps/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                                        
      <li>
  
                          <a href="../../tps/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../tps/api.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                              <li class="nav-header">UWB documentation</li>
                              
      <li>
  
                          <a href="../../uwb/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                  
      <li>
  
                          <a href="../../uwb/installation/index.html" title="Installation">
          <span class="icon-chevron-right"></span>
        Installation</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../uwb/configuration/application/index.html" title="Application Configuration">
          <span class="icon-chevron-right"></span>
        Application Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../uwb/configuration/office/index.html" title="Office Configuration">
          <span class="icon-chevron-right"></span>
        Office Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../uwb/features/index.html" title="Advanced Features">
          <span class="icon-chevron-right"></span>
        Advanced Features</a>
                  </li>
                                                                  
      <li>
  
                          <a href="../../uwb/operations/index.html" title="Operations">
          <span class="icon-chevron-right"></span>
        Operations</a>
                  </li>
                
      <li>
  
                          <a href="../../uwb/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">MIGRATION documentation</li>
                              
      <li>
  
                          <a href="../../migration/index.html" title="User Guide">
          <span class="none"></span>
        User Guide</a>
            </li>
                              <li class="nav-header">Appendix</li>
                              
      <li>
  
                          <a href="../../glossary.html" title="Glossary">
          <span class="none"></span>
        Glossary</a>
            </li>
                
      <li>
  
                          <a href="../../component-versions.html" title="Component Versions">
          <span class="none"></span>
        Component Versions</a>
            </li>
                                                                                                                                          
      <li>
  
                          <a href="../../release-migration-notes.html" title="Release And Migration Notes">
          <span class="icon-chevron-right"></span>
        Release And Migration Notes</a>
                  </li>
                
      <li>
  
                          <a href="../../changelog.html" title="Changelog">
          <span class="none"></span>
        Changelog</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Perform risk assessments</h1>
<p><b>Scenarios:</b></p>
<ul>

<li><a href="#scenario-getting-started">Getting started</a></li>
<li><a href="#scenario-invalid-assessment">Invalid assessment</a></li>
</ul>
<p><a name="scenario-getting-started"></a></p><section>
<h2><a name="Scenario:_Getting_started"></a>Scenario: Getting started</h2>
<p>To start a risk assessment the following steps must be gone through.</p><section>
<h3><a name="Choose_a_language"></a>Choose a language<a name="language"></a></h3>
<p>Currently there is no REST resource available to request the available languages of a knowledge base.</p>
<p>The textual representation of a language consists of:</p>
<ul>

<li>a required language code</li>
<li>an optional country code, which may only be specified if a language code has also been specified</li>
<li>an optional dialect specifier, which may only be specified if a country code has also been specified</li>
</ul>
<p>each separated by <code>'-'</code> character.</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th align="left"> language definition </th>
<th align="left"> explanation </th></tr>
</thead><tbody>

<tr class="b">
<td align="left"><code>&quot;language&quot;: &quot;en&quot;</code></td>
<td align="left"> This is the required language code</td></tr>
<tr class="a">
<td align="left"><code>&quot;language&quot;: &quot;en-GB&quot;</code></td>
<td align="left"> This is a language code with a country code</td></tr>
<tr class="b">
<td align="left"><code>&quot;language&quot;: &quot;en-GB-cockney&quot;</code></td>
<td align="left">  Now a dialect is added to language code and country code</td></tr>
</tbody>
</table>
<p>The language id for English is <code>en</code>. A request needs to contain this definition as part of the parameter sequence (<code>language=en</code>).</p>
<p>The JSON document has to contain the language with <code>&quot;language&quot;: &quot;&lt;language id&gt;&quot;</code> where <code>&quot;&lt;language id&gt;&quot;</code> has to be replaced by <code>&quot;en&quot;</code>. This can be changed during an assessment if more languages are supported by the knowledge base.</p></section><section>
<h3><a name="Select_product"></a>Select product<a name="product"></a></h3>
<p>The product is the subject the assessment is done for. A knowledge base may contain one or more products. A risk assessment can only be done for one product (with or without one or more riders) at a time. Riders are products themselves that are combined with a main product. Both form a product bundle (e.g. life insurance combined with occupational disability insurance and endowment insurance).</p>
<p>The product selection must be done before a risk assessment can be started. To select a product, perform a request to the products resource and select one of the products by its id from the response list (see usage scenario <a href="list-products.html">&#x201c;List products&#x201d;</a>).</p></section><section>
<h3><a name="Retrieve_initial_question_set"></a>Retrieve initial question set<a name="set"></a></h3>
<p>Perform a request to the risk assessment resource for a selected language id (<code>&quot;&lt;language id&gt;&quot;</code>) with the product id (<code>&quot;&lt;product id&gt;&quot;</code>) of choice. The response contains the initial question set collected at a questionnaire.</p>
<p>Send a <b>POST</b> request to the risk assessment sub-resource (<code>/riskassessments</code>) with the URI</p>

<div class="source">
<div class="source"><pre class="prettyprint">/rs/knowledgebases/{kb}/versions/{version}/riskassessments
</pre></div></div>

<p>and message body</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;language&quot;: &quot;&lt;language id&gt;&quot;,
    &quot;products&quot;: [{
        &quot;id&quot;: &quot;&lt;product id&gt;&quot;
    }]
}
</pre></div></div>

<p>For the knowledge base <code>myKBname</code> with version <code>X-YY-Z-release-20YYMMDD-HHMM</code> and a selected <code>&quot;&lt;language id&gt;&quot;</code> choice is <code>&quot;en&quot;</code> and <code>&quot;&lt;product id&gt;&quot;</code> choice is <code>&quot;AnyProduct&quot;</code> e.g.</p>

<div class="source">
<div class="source"><pre class="prettyprint">POST /rs/knowledgebases/myKBname/versions/X-YY-Z-release-20YYMMDD-HHMM/riskassessments

{
    &quot;language&quot;: &quot;en&quot;,
    &quot;products&quot;: [{
        &quot;id&quot;: &quot;AnyProduct&quot;
    }]
}
</pre></div></div>

<p>the body of the response contains the JSON document with the first collections of questions at the <code>questionnaire</code> section.</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
   &quot;language&quot;: &quot;en&quot;,
   &quot;completed&quot;: false,
   &quot;valid&quot;: true,
   &quot;conversationId&quot;: &quot;9ef0c41b-816f-4f33-9411-0b2eb4bd4520&quot;,
   &quot;products&quot;: [{&quot;id&quot;: &quot;AnyProduct&quot;}],
   &quot;questionnaire&quot;: {
        &quot;hasNewData&quot;: true,
        &quot;meta&quot;: {...},
        &quot;questions&quot;: [
            {
                &quot;type&quot;: &quot;text&quot;,
                &quot;id&quot;: &quot;InsuredPerson.FirstName&quot;,
                &quot;scope&quot;: &quot;ASSESSMENTFACTOR:InsuredPerson&quot;,
                &quot;isNew&quot;: true,
                &quot;caption&quot;: &quot;first name&quot;,
                &quot;constraints&quot;: {...},
                &quot;meta&quot;: {..},
                &quot;tags&quot;: {...},
                &quot;hasReflexive&quot;: false,
                &quot;answerState&quot;: &quot;missing&quot;,
                &quot;assignedTo&quot;: &quot;Applicant&quot;
            },
            {...}
        ]
   },
   &quot;meta&quot;: {..},
   &quot;links&quot;: {..},
   &quot;assessmentFactors&quot;:[ {..},{..},..],
   &quot;results&quot;: {
   &quot;products&quot;: [ {..},.. ],
   &quot;covers&quot;:[ {..}, {..}, .. ],
}
</pre></div></div>
</section><section>
<h3><a name="Answer_questions"></a>Answer questions<a name="answer"></a></h3>
<p>Answers to questions need to be added to the question section according to the type of the dedicated question (for question types see section <a href="../media-types/questionnaire.html">questionnaire</a>).</p>
<p>Generally the question section to be answered is extended with an expression</p>

<div class="source">
<div class="source"><pre class="prettyprint">..
&quot;answer&quot; : &lt;content&gt;
..
</pre></div></div>

<p><i>Example:</i> The text question <code>InsuredPerson.FirstName</code> of the initial questionnaire is answered with <code>John</code>.</p>

<div class="source">
<div class="source"><pre class="prettyprint">..
&quot;questions&quot;: [
    {
        &quot;type&quot;: &quot;text&quot;,
        &quot;id&quot;: &quot;InsuredPerson.FirstName&quot;,
        &quot;scope&quot;: &quot;ASSESSMENTFACTOR:InsuredPerson&quot;,
        &quot;isNew&quot;: true,
        &quot;caption&quot;: &quot;first name&quot;,
        &quot;constraints&quot;: {...},
        &quot;meta&quot;: {..},
        &quot;tags&quot;: {...},
        &quot;hasReflexive&quot;: false,
        &quot;answerState&quot;: &quot;missing&quot;,
        &quot;index&quot;: &quot;1&quot;,
        &quot;assignedTo&quot;: &quot;Applicant&quot;,
        
        &quot;answer&quot;: &quot;John&quot;
    },
    {..}
],
..
</pre></div></div>

<p>There is no need to answer all questions within one assessment cycle. The response will always contain all questions that still need to be answered.</p></section><section>
<h3><a name="Request-response_cycles"></a>Request-response cycles<a name="cycles"></a></h3>
<p>Each risk assessment is performed in request-response cycles. As soon as the risk assessment is initiated the questionnaire contains the first set of questions. Even if no question is answered a processing request can be performed. The result will be a response with just the same question set.</p>
<p>Answered questions can change the question set with the next request-response. The response contains less or additional questions depending on the answers given by the client.</p>
<p>The questionnaire will be enriched by the client and the system with more information (questions and answers) with each request-response cycle. The questionnaire with all questions and answers is always part of the request and response body.</p>
<p>While this scenario holds for most answered questions, a question of type <code>AssessmentFactorSearch</code> needs an additional request to get the associated question set. An additional request to the sub-resource ending with <code>/assessmentFactors</code> has to be performed to retrieve the associated questions sets. The URI references needed are provided with the JSON assessment document at the section <code>&quot;links&quot;: [..]</code>.</p>

<div class="source">
<div class="source"><pre class="prettyprint">..
&quot;links&quot;: [{
    &quot;href&quot;: &quot;/rs/knowledgebases/myKBname/versions/
                    X-YY-Z-release-20YYMMDD-HHMM/assessmentfactors&quot;,
    &quot;rel&quot;: [&quot;search-assessmentfactors&quot;],
    &quot;method&quot;: &quot;GET&quot;,
    &quot;params&quot;: {
       &quot;limit&quot;: null,
       &quot;q&quot;: null,
       &quot;questionId&quot;: &quot;SmokeTest_AFSearch&quot;,
       &quot;language&quot;: &quot;en&quot;
    }
}],
..
</pre></div></div>

<p>Necessary parameter sequences must be constructed from the <code>&quot;params&quot;</code> section of the <code>&quot;links&quot;: [..]</code> section for the request where <code>q</code> is the user&#x2019;s answer (<code>limit</code> is optional).</p>
<p>The parameter sequence related to the fragment shown above added to the end of the resource URI is, for instance</p>

<div class="source">
<div class="source"><pre class="prettyprint">GET  /rs/knowledgebases/myKBname/versions/X-YY-Z-release-20YYMMDD-HHMM/assessmentfactors?q=&lt;answer&gt;&amp;language=en&amp;questionId=SmokeTest_AFSearch
</pre></div></div>

<p>The response is a JSON document with a list of all assessment factors, if there exist any.</p>
<p>Depending on the response the <code>&quot;answer&quot;:&lt;..&gt;</code> must be set within the section of the <code>AssessmentFactorSearch</code> question and the next assessment request is started to update the questionnaire.</p>
<p>The request-response cycles end when all questions are answered and no more additional questions exist that need an answer. In this case a final result is calculated and contained in the JSON document of the response.</p>
<p>To track the state of a risk assessment along subsequent requests, the attribute <code>&quot;conversationId&quot;</code> can be used. See <a href="../media-types/riskassessment.html#properties-conversationId">conversationId</a> for further information.</p>
<p><a name="scenario-invalid-assessment"></a></p></section></section><section>
<h2><a name="Scenario:_Invalid_assessment"></a>Scenario: Invalid assessment</h2>
<p>A risk assessment may become <a href="../media-types/riskassessment.html#properties-valid">invalid</a>. This may occur in the following cases:</p>
<ul>

<li>A question has been answered such that a constraint or validation of a question or product defined in the knowledge base is violated, thereby triggering an error.</li>
<li>A question of type <a href="../media-types/structure-question.html">structure</a> is answered partially, i.e. an element of the structure question is not answered. Note that this also applies in cases where a structure question is nested within a list question.</li>
</ul>
<p>In such cases, clients should let the user correct the answers marked as being invalid or incompletely answered and then perform a risk assessment again.</p>
<p>The outcome of an invalid risk assessment is affected by whether the risk assessment&#x2019;s stabilisation mechanism is enabled or disabled. The stabilisation mechanism is enabled by default and can be disabled using the <a href="../configuration.html#risk-assessment-stabilisation">configuration</a>. The following sections describe the <a href="#invalid-assessment-general">general behaviour</a> for invalid risk assessments, as well as the special behaviour when the stabilisation mechanism is <a href="#stabilisation-enabled">enabled</a> or <a href="#stabilisation-disabled">disabled</a>.</p>
<p><span id="invalid-assessment-general" /></p><section>
<h3><a name="General_behaviour"></a>General behaviour</h3>
<p><span id="general-policy-recompute-state-information" /></p><section>
<h4><a name="Re-computation_of_state_information"></a>Re-computation of state information</h4>
<p>Re-computation of state information for all questionnaire elements is performed. This is done in order to avoid that inconsistent information is delivered. Not re-computing the state information could yield strange situations where a question has been answered with a valid value, but its state says it is invalid/missing. Affected are the following question and questionnaire element properties:</p>
<ul>

<li><a href="../media-types/questionnaire-element.html#properties-isNew">isNew</a></li>
<li><a href="../media-types/question.html#properties-answerState">answerState</a></li>
</ul>
<p><span id="general-policy-update-error-messages" /></p></section><section>
<h4><a name="Update_of_error_messages"></a>Update of error messages</h4>
<p>All questions whose answer state has been computed to &#x201c;invalid&#x201d; will have a message of type &#x201c;error&#x201d; attached, indicating why the answer given is invalid. And vice-versa, all questions whose answer state has been computed to not being &#x201c;invalid&#x201d; will <b>not</b> have messages of type &#x201c;error&#x201d; attached.</p>
<p><span id="general-policy-add-new-questions" /></p></section><section>
<h4><a name="New_questions_are_added"></a>New questions are added</h4>
<p>New (reflexive) questions inferred from the knowledge base will be present in the resulting risk assessment&#x2019;s questionnaire, if they were inferred based on valid answers.</p>
<p>Note that when doing this, there may be (at least theoretically) situations where not all reflexive questions can be delivered. Any reflexive question depending on a question that has been invalidly answered cannot be delivered. Further, a reflexive question can depend on more than one question. So if any of those is invalidly answered, the reflexive question cannot be delivered. This is due to the fact that the RAS runtime is not able to infer the reflexive question from the knowledge base in such cases.</p>
<p><span id="general-policy-add-new-assessment-factors" /></p></section><section>
<h4><a name="New_assessment_factors_are_added"></a>New assessment factors are added</h4>
<p>All new assessment factors inferred from the knowledge base will be present in the resulting risk assessment.</p>
<p><span id="general-policy-no-results" /></p></section><section>
<h4><a name="No_results"></a>No results</h4>
<p>Assessment results will not be delivered in the resulting risk assessment.</p></section><section>
<h4><a name="Answering_list_question"></a>Answering list question</h4>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;type&quot;: &quot;list&quot;,
    &quot;id&quot;: &quot;InsuredPerson.DrugsTaken&quot;,
    &quot;scope&quot;: &quot;ASSESSMENTFACTOR:InsuredPerson&quot;,
    &quot;isNew&quot;: true,
    &quot;caption&quot;: &quot;Which drugs are you taking?&quot;,
    &quot;meta&quot;: {...},
    &quot;hasReflexive&quot;: false,
    &quot;answerState&quot;: &quot;valid&quot;,
    &quot;index&quot;: &quot;1&quot;,
    &quot;assignedTo&quot;: &quot;Applicant&quot;,
    &quot;constraints&quot;: {
        &quot;required&quot;: true
    },
    
    &quot;prototype&quot;: {
        &quot;type&quot;: &quot;struct&quot;,
        &quot;id&quot;: &quot;prototype&quot;,
        ...,
        &quot;elements&quot;: [{
            &quot;type&quot;: &quot;text&quot;,
            &quot;id&quot;: &quot;DrugName&quot;,
            ...
        },
        {
            &quot;type&quot;: &quot;assessment-factor-search&quot;,
            &quot;id&quot;: &quot;DrugTreatedDisease&quot;,
            ...
        }]
    },
    &quot;answer&quot;: [{
        &quot;type&quot;: &quot;struct&quot;,
        &quot;id&quot;: &quot;prototype&quot;,
        ...,
        &quot;elements&quot;: [{
            &quot;type&quot;: &quot;text&quot;,
            &quot;id&quot;: &quot;DrugName&quot;,
            ...,
            &quot;answer&quot;: &quot;Aspirin&quot;
        },
        {
            &quot;type&quot;: &quot;assessment-factor-search&quot;,
            &quot;id&quot;: &quot;DrugTreatedDisease&quot;,
            ...,
            &quot;answer&quot;: [{&quot;id&quot;: &quot;Headache&quot;, &quot;label&quot;: &quot;headache&quot;, ... }]
        }]
    }]
}
</pre></div></div>

<p>In order to answer a list question it is best practice to copy the prototype to the array of answers of the list question and add the answer field to it. In particular, if a list question of type structure is answered with a corresponding structure element for which all of its members are unanswered, the RAS Runtime infers that the risk assessment is invalid because the answer state of the list question is incomplete.</p>
<p><span id="stabilisation-enabled" /></p></section></section><section>
<h3><a name="Stabilisation_enabled"></a>Stabilisation enabled</h3>
<p><span id="stabilisation-enabled-policy-retain-questions-and-answers" /></p><section>
<h4><a name="Questions_and_answers_are_retained"></a>Questions and answers are retained</h4>
<p>All questionnaire elements and questions (together with their answers) that have been passed into the risk assessment are also present in the resulting risk assessment - even if a question&#x2019;s answer state is not &#x201c;valid&#x201d;. This is done in order to avoid loss of information and to deliver a questionnaire that clients can further work with.</p>
<p><span id="stabilisation-enabled-policy-questions-do-not-move" /></p></section><section>
<h4><a name="Questions_do_not_move"></a>Questions do not move</h4>
<p>It is guaranteed that all questionnaire elements and questions that have been passed into the risk assessment retain their position within the questionnaire, i.e. they have the same parent element as before and therefore do not &#x201c;move&#x201d;.</p>
<p><span id="stabilisation-enabled-policy-new-questions-have-no-indices" /></p></section><section>
<h4><a name="New_questions_have_no_indices"></a>New questions have no indices</h4>
<p>New questions and questionnaire elements inferred from the knowledge base generally have no numerical <a href="../media-types/questionnaire-element.html#properties-index">index</a>. This is because in case of an invalid assessment it cannot be guaranteed that the numerical index of new elements is consistent with the resulting questionnaire structure. The numerical index for those elements will be available when the assessment becomes valid again.</p>
<p><span id="stabilisation-enabled-policy-retain-assessment-factors" /></p></section><section>
<h4><a name="Assessment_factors_are_retained"></a>Assessment factors are retained</h4>
<p>All assessment factors passed into the risk assessment will also be present in the resulting risk assessment.</p></section><section>
<h4><a name="Examples"></a>Examples</h4>
<p>Following are some examples demonstrating the behaviour in case of invalid risk assessments when the stabilisation mechanism is enabled.</p>
<ul>

<li>Standard cases
<ul>

<li><a href="#stabilisation-enabled-case-new-reflexive-questions">New reflexive questions</a></li>
<li><a href="#stabilisation-enabled-case-parent-question-becoming-invalid">Parent question becoming invalid</a></li>
</ul>
</li>
<li>Corner cases
<ul>

<li><a href="#stabilisation-enabled-case-differing-questionnaire-structure">Differing questionnaire structure</a></li>
<li><a href="#stabilisation-enabled-case-missing-reflexive-question">Missing reflexive question</a></li>
<li><a href="#stabilisation-enabled-case-partially-answered-structure-question">Partially answered structure question</a></li>
</ul>
</li>
</ul><section>
<h5><a name="Standard_cases"></a>Standard cases</h5>
<p><span id="stabilisation-enabled-case-new-reflexive-questions" /></p><section>
<h6><a name="New_reflexive_questions"></a>New reflexive questions</h6>
<p>Given an &#x201c;initial&#x201d; risk assessment with unanswered questions as shown below.</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;valid&quot;: true,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [
            {
                &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
                &quot;index&quot;: &quot;1&quot;,
                &quot;isNew&quot;: true,
                &quot;answerState&quot;: &quot;missing&quot;,
                ...
            },
            {
                &quot;id&quot;: &quot;PreviousDiseases&quot;,
                &quot;index&quot;: &quot;2&quot;,
                &quot;isNew&quot;: true,
                &quot;answerState&quot;: &quot;missing&quot;,
                ...
            }
        ],
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;InsuredPerson&quot;, ...}],
    &quot;results&quot;: {
        &quot;products&quot;: [...]
    },
    ...
}
</pre></div></div>

<p>The date question <i>&#x201c;InsuredPerson.DateOfBirth&#x201d;</i> is answered with an invalid value of <i>&#x201c;1800-01-01&#x201d;</i>. The assessment factor search question <i>&#x201c;PreviousDiseases&#x201d;</i> is answered with the valid assessment factor <i>Hypertension</i>, which will trigger further reflexive questions required from within an assessment factor group defined in the knowledge base.</p>
<p>A new risk assessment is then performed by a POST to the <a href="../rest-resources/riskassessments.html#riskassessments-POST">risk assessment</a> resource.</p>

<div class="source">
<div class="source"><pre class="prettyprint">POST /rs/knowledgebases/example-kb/versions/1-0-0/riskassessments
{
    &quot;valid&quot;: true,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [
            {
                &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
                &quot;index&quot;: &quot;1&quot;,
                &quot;isNew&quot;: true,
                &quot;answerState&quot;: &quot;missing&quot;,
                &quot;answer&quot;: &quot;1800-01-01&quot;,
                ...
            },
            {
                &quot;id&quot;: &quot;PreviousDiseases&quot;,
                &quot;index&quot;: &quot;2&quot;,
                &quot;isNew&quot;: true,
                &quot;answerState&quot;: &quot;missing&quot;,
                &quot;answer&quot;: [{&quot;id&quot;: &quot;Hypertension&quot;, ... }],
                ...
            }
        ],
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;InsuredPerson&quot;, ...}],
    &quot;results&quot;: {
        &quot;products&quot;: [...]
    },
    ...
}
</pre></div></div>

<p>This results in the following risk assessment:</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;valid&quot;: false,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [
            {
                &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
                &quot;index&quot;: &quot;1&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;invalid&quot;,
                &quot;answer&quot;: &quot;1800-01-01&quot;,
                &quot;messages&quot;: [{&quot;type&quot;: &quot;error&quot;, ...}],
                ...
            },
            {
                &quot;id&quot;: &quot;PreviousDiseases&quot;,
                &quot;index&quot;: &quot;2&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;valid&quot;,
                &quot;answer&quot;: [{&quot;id&quot;: &quot;Hypertension&quot;, ... }],
                ...,
                &quot;questions&quot;: [{
                    &quot;id&quot;: &quot;Hypertension&quot;,
                    &quot;isNew&quot;: true,
                    ...,
                    &quot;questions&quot;: [{
                        &quot;id&quot;: &quot;Hypertension.IsTreatedForHypertension&quot;,
                        &quot;isNew&quot;: true,
                        &quot;answerState&quot;: &quot;missing&quot;,
                        ...
                    },
                    {
                        &quot;Hypertension.WhatAppliesForHypertension&quot;,
                        &quot;isNew&quot;: true,
                        &quot;answerState&quot;: &quot;missing&quot;,
                        ...
                    }]
                }]
            }
        ],
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;InsuredPerson&quot;, ...}, {&quot;id&quot;: &quot;Hypertension&quot;, ...}]
}
</pre></div></div>

<p>There are a few things to notice here:</p>
<ul>

<li>The assessment has been marked as being invalid (property <i>&#x201c;valid&#x201d;</i> is set to <i>false</i>).</li>
<li>The assessment still contains the assessment factor <i>&#x201c;InsuredPerson&#x201d;</i>, as well as the new assessment factor <i>&#x201c;Hypertension&#x201d;</i> (which has been added by answering the <i>&#x201c;PreviousDiseases&#x201d;</i> question), according to the <a href="#stabilisation-enabled-policy-retain-assessment-factors">&#x201c;assessment factors are retained&#x201d;</a> and <a href="#general-policy-add-new-assessment-factors">&#x201c;new assessment factors are added&#x201d;</a> policies.</li>
<li>The results of the assessment have been removed, according to the <a href="#general-policy-no-results">&#x201c;no results&#x201d;</a> policy.</li>
<li>Question <i>&#x201c;InsuredPerson.DateOfBirth&#x201d;</i>
<ul>

<li>The question has been marked as invalid answered (property <i>&#x201c;answerState&#x201d;</i> has been set to <i>&#x201c;invalid&#x201d;</i>), according to the <a href="#general-policy-recompute-state-information">&#x201c;re-computation of state information&#x201d;</a> policy.</li>
<li>The question has been marked as not being new (property <i>&#x201c;isNew&#x201d;</i> has been set to <i>false</i>), according to the <a href="#general-policy-recompute-state-information">&#x201c;re-computation of state information&#x201d;</a> policy.</li>
<li>The question has a new error message, according to the <a href="#general-policy-update-error-messages">&#x201c;update of error messages&#x201d;</a> policy.</li>
<li>The answer given to the question is still present - even though it is invalid, according to the <a href="#stabilisation-enabled-policy-retain-questions-and-answers">&#x201c;questions and answers are retained&#x201d;</a> policy.</li>
</ul>
</li>
<li>Question <i>&#x201c;PreviousDiseases&#x201d;</i>
<ul>

<li>The question has been marked as valid answered (property <i>&#x201c;answerState&#x201d;</i> has been set to <i>&#x201c;valid&#x201d;</i>), according to the <a href="#general-policy-recompute-state-information">&#x201c;re-computation of state information&#x201d;</a> policy.</li>
<li>The question has been marked as not being new (property <i>&#x201c;isNew&#x201d;</i> has been set to <i>false</i>), according to the <a href="#general-policy-recompute-state-information">&#x201c;re-computation of state information&#x201d;</a> policy.</li>
<li>The question has new reflexive questions, according to the <a href="#general-policy-add-new-questions">&#x201c;new questions are added&#x201d;</a> policy. Further, these new questions have no numerical index, according to the <a href="#stabilisation-enabled-policy-new-questions-have-no-indices">&#x201c;new questions have no indices&#x201d;</a> policy.</li>
</ul>
</li>
</ul>
<p>Schematic questionnaire transition summary:</p>
<p><img src="../images/invalid-assessment/stabilisation-enabled-case-new-reflexive-questions.png" alt="" /></p>
<p><span id="stabilisation-enabled-case-parent-question-becoming-invalid" /></p></section><section>
<h6><a name="Parent_question_becoming_invalid"></a>Parent question becoming invalid</h6>
<p>Given a valid risk assessment with answered questions as shown below.</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;valid&quot;: true,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [
            {
                &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
                &quot;index&quot;: &quot;1&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;valid&quot;,
                &quot;answer&quot;: &quot;1970-01-01&quot;,
                ...,
                &quot;questions&quot;: [{
                    &quot;id&quot;: &quot;Occupations&quot;,
                    &quot;index&quot;: &quot;1.1&quot;,
                    &quot;isNew&quot;: false,
                    &quot;answerState&quot;: &quot;valid&quot;,
                    &quot;answer&quot;: [{&quot;id&quot;: &quot;Engineer&quot;, ... }],,
                ...,
                }]
            },
            {
                &quot;id&quot;: &quot;PreviousDiseases&quot;,
                &quot;index&quot;: &quot;2&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;missing&quot;,
                ...
            }
        ],
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;InsuredPerson&quot;, ...}, {&quot;id&quot;: &quot;Engineer&quot;, ...}],
    &quot;results&quot;: {
        &quot;products&quot;: [...]
    },
    ...
}
</pre></div></div>

<p>The date question <i>&#x201c;InsuredPerson.DateOfBirth&#x201d;</i> is answered with an invalid value of <i>&#x201c;1800-01-01&#x201d;</i>.</p>
<p>A new risk assessment is then performed by a POST to the <a href="../rest-resources/riskassessments.html#riskassessments-POST">risk assessment</a> resource.</p>

<div class="source">
<div class="source"><pre class="prettyprint">POST /rs/knowledgebases/example-kb/versions/1-0-0/riskassessments
{
    &quot;valid&quot;: true,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [
            {
                &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
                &quot;index&quot;: &quot;1&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;valid&quot;,
                &quot;answer&quot;: &quot;1800-01-01&quot;,
                ...,
                &quot;questions&quot;: [{
                    &quot;id&quot;: &quot;Occupations&quot;,
                    &quot;index&quot;: &quot;1.1&quot;,
                    &quot;isNew&quot;: false,
                    &quot;answerState&quot;: &quot;valid&quot;,
                    &quot;answer&quot;: [{&quot;id&quot;: &quot;Engineer&quot;, ... }],,
                ...,
                }]
            },
            {
                &quot;id&quot;: &quot;PreviousDiseases&quot;,
                &quot;index&quot;: &quot;2&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;missing&quot;,
                ...
            }
        ],
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;InsuredPerson&quot;, ...}, {&quot;id&quot;: &quot;Engineer&quot;, ...}],
    &quot;results&quot;: {
        &quot;products&quot;: [...]
    },
    ...
}
</pre></div></div>

<p>This results in the following risk assessment:</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;valid&quot;: false,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [
            {
                &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
                &quot;index&quot;: &quot;1&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;invalid&quot;,
                &quot;answer&quot;: &quot;1800-01-01&quot;,
                &quot;messages&quot;: [{&quot;type&quot;: &quot;error&quot;, ...}],
                ...,
                &quot;questions&quot;: [{
                    &quot;id&quot;: &quot;Occupations&quot;,
                    &quot;index&quot;: &quot;1.1&quot;,
                    &quot;isNew&quot;: false,
                    &quot;answerState&quot;: &quot;valid&quot;,
                    &quot;answer&quot;: [{&quot;id&quot;: &quot;Engineer&quot;, ... }],,
                ...,
                }]
            },
            {
                &quot;id&quot;: &quot;PreviousDiseases&quot;,
                &quot;index&quot;: &quot;2&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;missing&quot;,
                ...
            }
        ],
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;InsuredPerson&quot;, ...}, {&quot;id&quot;: &quot;Engineer&quot;, ...}],
    ...
}
</pre></div></div>

<p>There are a few things to notice here:</p>
<ul>

<li>The assessment has been marked as being invalid (property <i>&#x201c;valid&#x201d;</i> is set to <i>false</i>).</li>
<li>The assessment still contains the assessment factor <i>&#x201c;Engineer&#x201d;</i> (even though the <i>&#x201c;Occupations&#x201d;</i> question is a reflexive question of the invalid answered question <i>&#x201c;InsuredPerson.DateOfBirth&#x201d;</i>), according to the <a href="#stabilisation-enabled-policy-retain-assessment-factors">&#x201c;assessment factors are retained&#x201d;</a> policy.</li>
<li>The results of the assessment have been removed, according to the <a href="#general-policy-no-results">&#x201c;no results&#x201d;</a> policy.</li>
<li>Question <i>&#x201c;InsuredPerson.DateOfBirth&#x201d;</i>
<ul>

<li>The question has been marked as invalid answered (property <i>&#x201c;answerState&#x201d;</i> has been set to <i>&#x201c;invalid&#x201d;</i>), according to the <a href="#general-policy-recompute-state-information">&#x201c;re-computation of state information&#x201d;</a> policy.</li>
<li>The question has a new error message, according to the <a href="#general-policy-update-error-messages">&#x201c;update of error messages&#x201d;</a> policy.</li>
<li>The answer given to the question is still present - even though it is invalid, according to the <a href="#stabilisation-enabled-policy-retain-questions-and-answers">&#x201c;questions and answers are retained&#x201d;</a> policy.</li>
</ul>
</li>
<li>Question <i>&#x201c;Occupations&#x201d;</i>
<ul>

<li>The question and its answer is still present (even though the answer to the <i>&#x201c;InsuredPerson.DateOfBirth&#x201d;</i> question that has triggered this reflexive question has become invalid), according to the <a href="#stabilisation-enabled-policy-retain-questions-and-answers">&#x201c;questions and answers are retained&#x201d;</a> policy.</li>
<li>The question is still marked as valid answered (property <i>&#x201c;answerState&#x201d;</i> is still set to <i>&#x201c;valid&#x201d;</i>), since its answer <i>is</i> valid.</li>
</ul>
</li>
</ul>
<p>Schematic questionnaire transition summary:</p>
<p><img src="../images/invalid-assessment/stabilisation-enabled-case-parent-question-becoming-invalid.png" alt="" /></p></section></section><section>
<h5><a name="Corner_cases"></a>Corner cases</h5>
<p><span id="stabilisation-enabled-case-differing-questionnaire-structure" /></p><section>
<h6><a name="Differing_questionnaire_structure"></a>Differing questionnaire structure</h6>
<p>There are situations where a different questionnaire structure is delivered than inferred from the knowledge base, resulting in new reflexive questions having a different parent than reported by the RAS runtime.</p>
<p>Consider for example the following knowledge base definition:</p>

<div class="source">
<div class="source"><pre class="prettyprint">require A
require B

if A ... then require C
if B ... then require C

if C ... then require D
</pre></div></div>

<p>Given a questionnaire resulted from a previous risk assessment with</p>
<ul>

<li>question <i>&#x201c;A&#x201d;</i> answered with a valid value, having inferred the reflexive question <i>&#x201c;C&#x201d;</i></li>
<li>question <i>&#x201c;B&#x201d;</i> unanswered</li>
<li>and question <i>&#x201c;C&#x201d;</i> unanswered.</li>
</ul>
<p>Then</p>
<ul>

<li>question <i>&#x201c;A&#x201d;</i> is answered with an invalid value, so that the assessment will become invalid</li>
<li>question <i>&#x201c;B&#x201d;</i> is answered with a valid value, so that this would trigger the reflexive question <i>&#x201c;C&#x201d;</i></li>
<li>question <i>&#x201c;C&#x201d;</i> is answered with a valid value, so that this would trigger the reflexive question <i>&#x201c;D&#x201d;</i></li>
</ul>
<p>and a new risk assessment is performed.</p>
<p>The following schematic diagram shows the processing of the questionnaire for that risk assessment:</p>
<p><img src="../images/invalid-assessment/stabilisation-enabled-case-differing-questionnaire-structure.png" alt="" /></p>
<p>The knowledge base inferred</p>
<ul>

<li>question <i>&#x201c;C&#x201d;</i> as a reflexive child question of question <i>&#x201c;B&#x201d;</i> (rather than a child question of question <i>&#x201c;A&#x201d;</i>), since <i>&#x201c;A&#x201d;</i> has been invalid answered and therefore the condition <i>&#x201c;if A &#x2026;&#x201d;</i> could not be evaluated</li>
<li>and question <i>&#x201c;D&#x201d;</i> as a new reflexive child question of question <i>&#x201c;C&#x201d;</i>, since <i>&#x201c;C&#x201d;</i> has been valid answered and the condition <i>&#x201c;if C &#x2026;&#x201d;</i> has been evaluated.</li>
</ul>
<p>Due to the <a href="#stabilisation-enabled-policy-questions-do-not-move">&#x201c;questions do not move&#x201d;</a> policy, question <i>&#x201c;C&#x201d;</i> remains a reflexive child question of question <i>&#x201c;A&#x201d;</i> (even though it is invalid answered), and therefore the new reflexive question <i>&#x201c;D&#x201d;</i> is inserted into the <i>&#x201c;A&#x201d;</i>-branch of the questionnaire tree. Further, question <i>&#x201c;D&#x201d;</i> has no numerical index, according to the <a href="#stabilisation-enabled-policy-new-questions-have-no-indices">&#x201c;new questions have no indices&#x201d;</a> policy.</p>
<p><span id="stabilisation-enabled-case-missing-reflexive-question" /></p></section><section>
<h6><a name="Missing_reflexive_question"></a>Missing reflexive question</h6>
<p>There are situations where not all reflexive questions can be delivered.</p>
<p>Consider for example the following knowledge base definition:</p>

<div class="source">
<div class="source"><pre class="prettyprint">require A
require B

if A ... or B ... then require C
</pre></div></div>

<p>Here, question <i>&#x201c;C&#x201d;</i> depends on the answers given to question <i>&#x201c;A&#x201d;</i> and <i>&#x201c;B&#x201d;</i>. When answering question <i>&#x201c;A&#x201d;</i> with a valid value and question <i>&#x201c;B&#x201d;</i> with an invalid value (due to e.g. constraints or input validations), one might expect the reflexive question <i>&#x201c;C&#x201d;</i> to be inferred when performing a risk assessment. But since question <i>&#x201c;B&#x201d;</i> has been answered with an invalid value, the condition <i>&#x201c;if A &#x2026; or B &#x2026;&#x201d;</i> is not evaluated at all. This means that the reflexive question <i>&#x201c;C&#x201d;</i> will not be inferred when performing a risk assessment.</p>
<p>The following schematic diagram shows the processing of the questionnaire for that risk assessment:</p>
<p><img src="../images/invalid-assessment/stabilisation-enabled-case-missing-reflexive-question.png" alt="" /></p>
<p><span id="stabilisation-enabled-case-partially-answered-structure-question" /></p></section><section>
<h6><a name="Partially_answered_structure_question"></a>Partially answered structure question</h6>
<p>In case of partially answered structure questions, there are situations where not all reflexive questions can be delivered and there is no error message even though the assessment has been marked as being invalid.</p>
<p>Consider the following knowledge base definition:</p>

<div class="source">
<div class="source"><pre class="prettyprint">require DrugTaken
</pre></div></div>

<p>with <i>&#x201c;DrugTaken&#x201d;</i> being a structure assessment variable defined as follows:</p>

<div class="source">
<div class="source"><pre class="prettyprint">AssessmentVariable DrugTaken {
    type DrugTakenStructure
    global
}

Structure DrugTakenStructure {
    AssessmentVariable DrugName {
        type String
    }
    AssessmentVariable DrugTreatedDisease {
        type AssessmentFactorSearch
        matches category == Medical
    }
}
</pre></div></div>

<p>and <i>&#x201c;Asthma&#x201d;</i> being an assessment factor for which reflexive questions are triggered from within an assessment factor group:</p>

<div class="source">
<div class="source"><pre class="prettyprint">AssessmentFactorGroup AsthmaGroup covers ... {
  assessmentFactors Asthma

  rules for ... {
    flow {
      require HadHospitalStayLast3Years
    }
    ...
  }
}
</pre></div></div>

<p>The structure question <i>&#x201c;DrugTaken&#x201d;</i> is answered partially with valid assessment factor <i>&#x201c;Asthma&#x201d;</i> for the <i>&#x201c;DrugTreatedDisease&#x201d;</i> element and without an answer for the <i>&#x201c;DrugName&#x201d;</i> element of the structure.</p>
<p>A new risk assessment is then performed by a POST to the <a href="../rest-resources/riskassessments.html#riskassessments-POST">risk assessment</a> resource.</p>

<div class="source">
<div class="source"><pre class="prettyprint">POST /rs/knowledgebases/example-kb/versions/1-0-0/riskassessments
{
    &quot;language&quot;: &quot;en&quot;,
    &quot;completed&quot;: false,
    &quot;valid&quot;: false,
    &quot;conversationId&quot;: &quot;9ef0c41b-816f-4f33-9411-0b2eb4bd4520&quot;,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [{
            &quot;type&quot;: &quot;struct&quot;,
            &quot;id&quot;: &quot;DrugTaken&quot;,
            &quot;state&quot;: &quot;new&quot;,
            &quot;answerState&quot;: &quot;missing&quot;,
            &quot;elements&quot;: [{
                &quot;type&quot;: &quot;text&quot;,
                &quot;id&quot;: &quot;DrugName&quot;,
                &quot;state&quot;: &quot;new&quot;,
                &quot;answerState&quot;: &quot;missing&quot;,
                ...
            },
            {
                &quot;type&quot;: &quot;assessment-factor-search&quot;,
                &quot;id&quot;: &quot;DrugTreatedDisease&quot;,
                &quot;state&quot;: &quot;new&quot;,
                &quot;answerState&quot;: &quot;missing&quot;,
                &quot;answer&quot;: [{&quot;id&quot;: &quot;Asthma&quot;, ... }],
                ...
            }],
            ...
        }]
    },
    ...
}
</pre></div></div>

<p>This results in the following risk assessment:</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;language&quot;: &quot;en&quot;,
    &quot;completed&quot;: false,
    &quot;valid&quot;: false,
    &quot;conversationId&quot;: &quot;9ef0c41b-816f-4f33-9411-0b2eb4bd4520&quot;,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [{
            &quot;type&quot;: &quot;struct&quot;,
            &quot;id&quot;: &quot;DrugTaken&quot;,
            &quot;state&quot;: &quot;valid&quot;,
            &quot;answerState&quot;: &quot;incomplete&quot;,
            &quot;elements&quot;: [{
                &quot;type&quot;: &quot;text&quot;,
                &quot;id&quot;: &quot;DrugName&quot;,
                &quot;state&quot;: &quot;invalid&quot;,
                &quot;answerState&quot;: &quot;missing&quot;,
                ...
            },
            {
                &quot;type&quot;: &quot;assessment-factor-search&quot;,
                &quot;id&quot;: &quot;DrugTreatedDisease&quot;,
                &quot;state&quot;: &quot;valid&quot;,
                &quot;answerState&quot;: &quot;valid&quot;,
                &quot;answer&quot;: [{&quot;id&quot;: &quot;Asthma&quot;, ... }],
                ...
            }],
            ...
        }]
    },
    ...
}
</pre></div></div>

<p>Notice:</p>
<ul>

<li>The assessment has been marked as being invalid (property <i>&#x201c;valid&#x201d;</i> is set to <i>false</i>).</li>
<li>Question <i>&#x201c;DrugTaken&#x201d;</i>
<ul>

<li>The question has been marked as incompletely answered (property <i>&#x201c;answerState&#x201d;</i> has been set to <i>&#x201c;incomplete&#x201d;</i>).</li>
<li>The element <i>&#x201c;DrugName&#x201d;</i> has been marked as missing an answer (property <i>&#x201c;answerState&#x201d;</i> has been set to <i>&#x201c;missing&#x201d;</i>).</li>
<li>The element <i>&#x201c;DrugTreatedDisease&#x201d;</i> has been marked as valid answered (property <i>&#x201c;answerState&#x201d;</i> has been set to <i>&#x201c;valid&#x201d;</i>).</li>
<li>There is no error message, indicating that an element of the structure question has not been answered. Currently, there is no way to define such messages for a knowledge base. Therefore, in case of an invalid assessment, clients must also check for incompletely answered questions. This is a <a href="../known-issues/partially-answered-structure-questions.html">known issue</a> that may get fixed in future version.</li>
<li>While the answer (i.e. assessment factor <i>&#x201c;Asthma&#x201d;</i>) for the <i>&#x201c;DrugTreatedDisease&#x201d;</i> element is still present, the reflexive questions for the <i>&#x201c;Asthma&#x201d;</i> assessment factor are missing. This is because the RAS runtime can only infer reflexive questions from a knowledge base if all elements of a structure have been answered. This is a <a href="../known-issues/partially-answered-structure-questions.html">known issue</a> that may get fixed in future version.</li>
</ul>
</li>
</ul>
<p><span id="stabilisation-disabled" /></p></section></section></section></section><section>
<h3><a name="Stabilisation_disabled"></a>Stabilisation disabled</h3>
<p><span id="stabilisation-disabled-policy-remove-obsolete-questions" /></p><section>
<h4><a name="Obsolete_questions_are_removed"></a>Obsolete questions are removed</h4>
<p>All questionnaire elements and questions that have been passed into the risk assessment but that are no longer inferred from the knowledge base (possibly because one of their parent questions has become invalid) are removed from the questionnaire in the resulting risk assessment.</p>
<p><span id="stabilisation-disabled-policy-questions-may-move" /></p></section><section>
<h4><a name="Questions_may_move"></a>Questions may move</h4>
<p>It cannot be guaranteed that all questionnaire elements and questions that have been passed into the risk assessment retain position within the questionnaire, i.e. they may have a different parent element than before and therefore may &#x201c;move&#x201d;.</p>
<p><span id="stabilisation-disabled-policy-new-questions-have-indices" /></p></section><section>
<h4><a name="New_questions_have_indices"></a>New questions have indices</h4>
<p>All new questions and questionnaire elements inferred from the knowledge base generally have a numerical <a href="../media-types/questionnaire-element.html#properties-index">index</a>.</p>
<p><span id="stabilisation-disabled-policy-update-assessment-factors" /></p></section><section>
<h4><a name="Assessment_factors_are_updated"></a>Assessment factors are updated</h4>
<p>Only those assessment factors that could be inferred from the knowledge base will be present in the resulting risk assessment. This implies that all assessment factors that are no longer inferred from the knowledge base are removed in the resulting risk assessment.</p></section><section>
<h4><a name="Examples"></a>Examples</h4>
<p>Following are some examples demonstrating the behaviour in case of invalid risk assessments when the stabilisation mechanism is enabled.</p>
<ul>

<li>Standard cases
<ul>

<li><a href="#stabilisation-disabled-case-new-reflexive-questions">New reflexive questions</a></li>
<li><a href="#stabilisation-disabled-case-parent-question-becoming-invalid">Parent question becoming invalid</a></li>
</ul>
</li>
<li>Corner cases
<ul>

<li><a href="#stabilisation-disabled-case-moving-questions">Moving questions</a></li>
</ul>
</li>
</ul><section>
<h5><a name="Standard_cases"></a>Standard cases</h5>
<p><span id="stabilisation-disabled-case-new-reflexive-questions" /></p><section>
<h6><a name="New_reflexive_questions"></a>New reflexive questions</h6>
<p>Given an &#x201c;initial&#x201d; risk assessment with unanswered questions as shown below.</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;valid&quot;: true,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [{
            &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
            &quot;index&quot;: &quot;1&quot;,
            &quot;isNew&quot;: true,
            &quot;answerState&quot;: &quot;missing&quot;,
            ...
        },
        {
            &quot;id&quot;: &quot;PreviousDiseases&quot;,
            &quot;index&quot;: &quot;2&quot;,
            &quot;isNew&quot;: true,
            &quot;answerState&quot;: &quot;missing&quot;,
            ...
        }]
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;InsuredPerson&quot;, ...}],
    &quot;results&quot;: {
        &quot;products&quot;: [...]
    },
    ...
}
</pre></div></div>

<p>The date question <i>&#x201c;InsuredPerson.DateOfBirth&#x201d;</i> is answered with an invalid value of <i>&#x201c;1800-01-01&#x201d;</i>. The assessment factor search question <i>&#x201c;PreviousDiseases&#x201d;</i> is answered with the valid assessment factor <i>Hypertension</i>, which will trigger further reflexive questions required from within an assessment factor group defined in the knowledge base.</p>
<p>A new risk assessment is then performed by a POST to the <a href="../rest-resources/riskassessments.html#riskassessments-POST">risk assessment</a> resource.</p>

<div class="source">
<div class="source"><pre class="prettyprint">POST /rs/knowledgebases/example-kb/versions/1-0-0/riskassessments
{
    &quot;valid&quot;: true,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [{
            &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
            &quot;index&quot;: &quot;1&quot;,
            &quot;isNew&quot;: true,
            &quot;answerState&quot;: &quot;missing&quot;,
            &quot;answer&quot;: &quot;1800-01-01&quot;,
            ...
        },
        {
            &quot;id&quot;: &quot;PreviousDiseases&quot;,
            &quot;index&quot;: &quot;2&quot;,
            &quot;isNew&quot;: true,
            &quot;answerState&quot;: &quot;missing&quot;,
            &quot;answer&quot;: [{&quot;id&quot;: &quot;Hypertension&quot;, ...}],
            ...
        }]
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;InsuredPerson&quot;, ...}],
    &quot;results&quot;: {
        &quot;products&quot;: [...]
    },
    ...
}
</pre></div></div>

<p>This results in the following risk assessment:</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;valid&quot;: false,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [{
            &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
            &quot;index&quot;: &quot;1&quot;,
            &quot;isNew&quot;: false,
            &quot;answerState&quot;: &quot;invalid&quot;
            &quot;answer&quot;: &quot;1800-01-01&quot;,
            &quot;messages&quot;: [{&quot;type&quot;: &quot;error&quot;, ...}],
            ...
        },
        {
            &quot;id&quot;: &quot;PreviousDiseases&quot;,
            &quot;index&quot;: &quot;2&quot;,
            &quot;isNew&quot;: false,
            &quot;answer&quot;: [{&quot;id&quot;: &quot;Hypertension&quot;, ...}],
            &quot;answerState&quot;: &quot;valid&quot;,
            ...,
            &quot;questions&quot;: [{
                &quot;id&quot;: &quot;Hypertension&quot;,
                &quot;isNew&quot;: true,
                ...,
                &quot;questions&quot;: [{
                    &quot;id&quot;: &quot;Hypertension.IsTreatedForHypertension&quot;,
                    &quot;index&quot;: &quot;2.1&quot;,
                    &quot;isNew&quot;: true,
                    &quot;answerState&quot;: &quot;missing&quot;,
                    ...
                },
                {
                    &quot;id&quot;: &quot;Hypertension.WhatAppliesForHypertension&quot;,
                    &quot;index&quot;: &quot;2.2&quot;,
                    &quot;isNew&quot;: true,
                    &quot;answerState&quot;: &quot;missing&quot;,
                    ...
                }]
            }]
        }]
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;Hypertension&quot;, ...}, {&quot;id&quot;: &quot;InsuredPerson&quot;, ...}],
    ...
}
</pre></div></div>

<p>There are a few things to notice here:</p>
<ul>

<li>The assessment has been marked as being invalid (property <i>&#x201c;valid&#x201d;</i> is set to <i>false</i>).</li>
<li>The assessment still contains the assessment factor <i>&#x201c;InsuredPerson&#x201d;</i>, as well as the new assessment factor <i>&#x201c;Hypertension&#x201d;</i> (which has been added by answering the <i>&#x201c;PreviousDiseases&#x201d;</i> question), according to the <a href="#stabilisation-disabled-policy-update-assessment-factors">&#x201c;assessment factors are updated&#x201d;</a> and <a href="#general-policy-add-new-assessment-factors">&#x201c;new assessment factors are added&#x201d;</a> policies.</li>
<li>The results of the assessment have been removed, according to the <a href="#general-policy-no-results">&#x201c;no results&#x201d;</a> policy.</li>
<li>Question <i>&#x201c;InsuredPerson.DateOfBirth&#x201d;</i>
<ul>

<li>The question has been marked as invalid answered (property <i>&#x201c;answerState&#x201d;</i> has been set to <i>&#x201c;invalid&#x201d;</i>), according to the <a href="#general-policy-recompute-state-information">&#x201c;re-computation of state information&#x201d;</a> policy.</li>
<li>The question has been marked as not being new (property <i>&#x201c;isNew&#x201d;</i> has been set to <i>false</i>), according to the <a href="#general-policy-recompute-state-information">&#x201c;re-computation of state information&#x201d;</a> policy.</li>
<li>The question has a new error message, according to the <a href="#general-policy-update-error-messages">&#x201c;update of error messages&#x201d;</a> policy.</li>
</ul>
</li>
<li>Question <i>&#x201c;PreviousDiseases&#x201d;</i>
<ul>

<li>The question has been marked as valid answered (property <i>&#x201c;answerState&#x201d;</i> has been set to <i>&#x201c;valid&#x201d;</i>), according to the <a href="#general-policy-recompute-state-information">&#x201c;re-computation of state information&#x201d;</a> policy.</li>
<li>The question has been marked as not being new (property <i>&#x201c;isNew&#x201d;</i> has been set to <i>false</i>), according to the <a href="#general-policy-recompute-state-information">&#x201c;re-computation of state information&#x201d;</a> policy.</li>
<li>The question has new reflexive questions, according to the <a href="#general-policy-add-new-questions">&#x201c;new questions are added&#x201d;</a> policy. Further, these new questions have numerical indices, according to the <a href="#stabilisation-disabled-policy-new-questions-have-indices">&#x201c;new questions have indices&#x201d;</a> policy.</li>
</ul>
</li>
</ul>
<p>Schematic questionnaire transition summary:</p>
<p><img src="../images/invalid-assessment/stabilisation-disabled-case-new-reflexive-questions.png" alt="" /></p>
<p><span id="stabilisation-disabled-case-parent-question-becoming-invalid" /></p></section><section>
<h6><a name="Parent_question_becoming_invalid"></a>Parent question becoming invalid</h6>
<p>Given a valid risk assessment with answered questions as shown below.</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;valid&quot;: true,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [
            {
                &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
                &quot;index&quot;: &quot;1&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;valid&quot;,
                &quot;answer&quot;: &quot;1970-01-01&quot;,
                ...,
                &quot;questions&quot;: [{
                    &quot;id&quot;: &quot;Occupations&quot;,
                    &quot;index&quot;: &quot;1.1&quot;,
                    &quot;isNew&quot;: false,
                    &quot;answerState&quot;: &quot;valid&quot;,
                    &quot;answer&quot;: [{&quot;id&quot;: &quot;Engineer&quot;, ... }],,
                ...,
                }]
            },
            {
                &quot;id&quot;: &quot;PreviousDiseases&quot;,
                &quot;index&quot;: &quot;2&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;missing&quot;,
                ...
            }
        ],
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;InsuredPerson&quot;, ...}, {&quot;id&quot;: &quot;Engineer&quot;, ...}],
    &quot;results&quot;: {
        &quot;products&quot;: [...]
    },
    ...
}
</pre></div></div>

<p>The date question <i>&#x201c;InsuredPerson.DateOfBirth&#x201d;</i> is answered with an invalid value of <i>&#x201c;1800-01-01&#x201d;</i>.</p>
<p>A new risk assessment is then performed by a POST to the <a href="../rest-resources/riskassessments.html#riskassessments-POST">risk assessment</a> resource.</p>

<div class="source">
<div class="source"><pre class="prettyprint">POST /rs/knowledgebases/example-kb/versions/1-0-0/riskassessments
{
    &quot;valid&quot;: true,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [
            {
                &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
                &quot;index&quot;: &quot;1&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;valid&quot;,
                &quot;answer&quot;: &quot;1800-01-01&quot;,
                ...,
                &quot;questions&quot;: [{
                    &quot;id&quot;: &quot;Occupations&quot;,
                    &quot;index&quot;: &quot;1.1&quot;,
                    &quot;isNew&quot;: false,
                    &quot;answerState&quot;: &quot;valid&quot;,
                    &quot;answer&quot;: [{&quot;id&quot;: &quot;Engineer&quot;, ... }],,
                ...,
                }]
            },
            {
                &quot;id&quot;: &quot;PreviousDiseases&quot;,
                &quot;index&quot;: &quot;2&quot;,
                &quot;isNew&quot;: false,
                &quot;answerState&quot;: &quot;missing&quot;,
                ...
            }
        ],
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;InsuredPerson&quot;, ...}, {&quot;id&quot;: &quot;Engineer&quot;, ...}],
    &quot;results&quot;: {
        &quot;products&quot;: [...]
    },
    ...
}
</pre></div></div>

<p>This results in the following risk assessment:</p>

<div class="source">
<div class="source"><pre class="prettyprint">{
    &quot;valid&quot;: false,
    &quot;products&quot;: [{...}],
    &quot;questionnaire&quot;: {
        &quot;questions&quot;: [{
            &quot;id&quot;: &quot;InsuredPerson.DateOfBirth&quot;,
            
            &quot;index&quot;: &quot;1&quot;,
            &quot;isNew&quot;: false,
            &quot;answerState&quot;: &quot;invalid&quot;,
            &quot;answer&quot;: &quot;1800-01-01&quot;,
            &quot;messages&quot;: [{&quot;message&quot;: &quot;MinValueNotReached&quot;, ...}],
            ...
        },
        {
            &quot;id&quot;: &quot;PreviousDiseases&quot;,
            &quot;index&quot;: &quot;2&quot;,
            &quot;isNew&quot;: false,
            &quot;answerState&quot;: &quot;missing&quot;
        }]
    },
    &quot;assessmentFactors&quot;: [{&quot;id&quot;: &quot;InsuredPerson&quot;, ...}],
    ...
}
</pre></div></div>

<p>There are a few things to notice here:</p>
<ul>

<li>The assessment has been marked as being invalid (property <i>&#x201c;valid&#x201d;</i> is set to <i>false</i>).</li>
<li>The assessment does not contain the assessment factor <i>&#x201c;Engineer&#x201d;</i> any more, according to the <a href="#stabilisation-disabled-policy-update-assessment-factors">&#x201c;assessment factors are updated&#x201d;</a> policy.</li>
<li>The results of the assessment have been removed, according to the <a href="#general-policy-no-results">&#x201c;no results&#x201d;</a> policy.</li>
<li>Question <i>&#x201c;InsuredPerson.DateOfBirth&#x201d;</i>
<ul>

<li>The question has been marked as invalid answered (property <i>&#x201c;answerState&#x201d;</i> has been set to <i>&#x201c;invalid&#x201d;</i>), according to the <a href="#general-policy-recompute-state-information">&#x201c;re-computation of state information&#x201d;</a> policy.</li>
<li>The question has a new error message, according to the <a href="#general-policy-update-error-messages">&#x201c;update of error messages&#x201d;</a> policy.</li>
</ul>
</li>
<li>Question <i>&#x201c;Occupations&#x201d;</i>
<ul>

<li>The question has been removed, according to the <a href="#stabilisation-disabled-policy-remove-obsolete-questions">&#x201c;obsolete questions are removed&#x201d;</a> policy.</li>
</ul>
</li>
</ul>
<p>Schematic questionnaire transition summary:</p>
<p><img src="../images/invalid-assessment/stabilisation-disabled-case-parent-question-becoming-invalid.png" alt="" /></p></section></section><section>
<h5><a name="Corner_cases"></a>Corner cases</h5>
<p><span id="stabilisation-disabled-case-moving-questions" /></p><section>
<h6><a name="Moving_questions"></a>Moving questions</h6>
<p>There are situations where questions change their position within the questionnaire.</p>
<p>Consider for example the following knowledge base definition:</p>

<div class="source">
<div class="source"><pre class="prettyprint">require A
require B

if A ... then require C
if B ... then require C

if C ... then require D
</pre></div></div>

<p>Given a questionnaire resulted from a previous risk assessment with</p>
<ul>

<li>question <i>&#x201c;A&#x201d;</i> answered with a valid value, having inferred the reflexive question <i>&#x201c;C&#x201d;</i></li>
<li>question <i>&#x201c;B&#x201d;</i> unanswered</li>
<li>and question <i>&#x201c;C&#x201d;</i> unanswered.</li>
</ul>
<p>Then</p>
<ul>

<li>question <i>&#x201c;A&#x201d;</i> is answered with an invalid value, so that the assessment will become invalid</li>
<li>question <i>&#x201c;B&#x201d;</i> is answered with a valid value, so that this would trigger the reflexive question <i>&#x201c;C&#x201d;</i></li>
<li>question <i>&#x201c;C&#x201d;</i> is answered with a valid value, so that this would trigger the reflexive question <i>&#x201c;D&#x201d;</i></li>
</ul>
<p>and a new risk assessment is performed.</p>
<p>The following schematic diagram shows the processing of the questionnaire for that risk assessment:</p>
<p><img src="../images/invalid-assessment/stabilisation-disabled-case-moving-questions.png" alt="" /></p>
<p>The knowledge base inferred</p>
<ul>

<li>question <i>&#x201c;C&#x201d;</i> as a reflexive child question of question <i>&#x201c;B&#x201d;</i> (rather than a child question of question <i>&#x201c;A&#x201d;</i>), since <i>&#x201c;A&#x201d;</i> has been invalid answered and therefore the condition <i>&#x201c;if A &#x2026;&#x201d;</i> could not be evaluated</li>
<li>and question <i>&#x201c;D&#x201d;</i> as a new reflexive child question of question <i>&#x201c;C&#x201d;</i>, since <i>&#x201c;C&#x201d;</i> has been valid answered and the condition <i>&#x201c;if C &#x2026;&#x201d;</i> has been evaluated.</li>
</ul>
<p>As can be seen the question <i>&#x201c;C&#x201d;</i> is now a reflexive child question of question <i>&#x201c;B&#x201d;</i>, and therefore the new reflexive question <i>&#x201c;D&#x201d;</i> is inserted into the <i>&#x201c;B&#x201d;</i>-branch of the questionnaire tree. Note also, that the index of question <i>&#x201c;C&#x201d;</i> has changed accordingly from &#x201c;1.1&#x201d; to &#x201c;2.1&#x201d;. Further, question <i>&#x201c;D&#x201d;</i> has a numerical index, according to the <a href="#stabilisation-disabled-policy-new-questions-have-indices">&#x201c;new questions have indices&#x201d;</a> policy.</p></section></section></section></section></section>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2020.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
