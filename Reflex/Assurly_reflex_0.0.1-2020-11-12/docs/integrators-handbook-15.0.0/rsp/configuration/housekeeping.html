<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 at 2020-09-25 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20200925" />
    <meta http-equiv="Content-Language" content="en" />
    <title>ReFlex ReFlex Integrator's Handbook &#x2013; Housekeeping</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://www.hannover-re.com/" id="bannerLeft">
                                                                                                <img src="../../images/logo.svg"  alt="HannoverRe"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="https://www.hannover-re.com/" id="bannerRight">
                                                                                                <img src="../../images/hre-logo.svg"  alt="HannoverRe_log"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="projectVersion">Version: 15.0.0
                    </li>
              
              
                  <li id="publishDate" class="pull-right">Last Published: 2020-09-25</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                          
      <li>
  
                          <a href="../../index.html" title="Document Information">
          <span class="none"></span>
        Document Information</a>
            </li>
                                                                                                                                                            
      <li>
  
                          <a href="../../reflex-overview/index.html" title="ReFlex Overview">
          <span class="icon-chevron-right"></span>
        ReFlex Overview</a>
                  </li>
                
      <li>
  
                          <a href="../../installation-guide.html" title="Installation Guide">
          <span class="none"></span>
        Installation Guide</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../update-guide/index.html" title="Update Guide">
          <span class="icon-chevron-right"></span>
        Update Guide</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../use-cases/index.html" title="Use Cases">
          <span class="icon-chevron-right"></span>
        Use Cases</a>
                  </li>
                              <li class="nav-header">RAS documentation</li>
                              
      <li>
  
                          <a href="../../ras/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../ras/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                                      
      <li>
  
                          <a href="../../ras/general-notes/index.html" title="General Notes">
          <span class="icon-chevron-right"></span>
        General Notes</a>
                  </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="../../ras/rest-resources/index.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                                                                                                                                                                                                                                                      
      <li>
  
                          <a href="../../ras/usage-scenarios/index.html" title="Usage Scenarios">
          <span class="icon-chevron-right"></span>
        Usage Scenarios</a>
                  </li>
                                                                                                                                          
      <li>
  
                          <a href="../../ras/known-issues/index.html" title="Known Issues">
          <span class="icon-chevron-right"></span>
        Known Issues</a>
                  </li>
                              <li class="nav-header">CEP documentation</li>
                              
      <li>
  
                          <a href="../../cep/integration/integration_mechanism.html" title="Integration Mechanism">
          <span class="none"></span>
        Integration Mechanism</a>
            </li>
                                                                                                                                                                                          
      <li>
  
                          <a href="../../cep/integration/backend/index.html" title="Back End Integration">
          <span class="icon-chevron-right"></span>
        Back End Integration</a>
                  </li>
                                                                                                                                                                                                                        
      <li>
  
                          <a href="../../cep/integration/frontend/index.html" title="Front End Integration">
          <span class="icon-chevron-right"></span>
        Front End Integration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../cep/integration/features/index.html" title="Optional Features">
          <span class="icon-chevron-right"></span>
        Optional Features</a>
                  </li>
                                                                                                                              
      <li>
  
                          <a href="../../cep/integration/operations/index.html" title="Operations">
          <span class="icon-chevron-right"></span>
        Operations</a>
                  </li>
                
      <li>
  
                          <a href="../../cep/integration/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">DCS documentation</li>
                              
      <li>
  
                          <a href="../../dcs/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                
      <li>
  
                          <a href="../../dcs/configuration.html" title="Configuration">
          <span class="none"></span>
        Configuration</a>
            </li>
                
      <li>
  
                          <a href="../../dcs/rest-api.html" title="REST API">
          <span class="none"></span>
        REST API</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../dcs/template-config/template-configuration.html" title="Template Configuration">
          <span class="icon-chevron-right"></span>
        Template Configuration</a>
                  </li>
                
      <li>
  
                          <a href="../../dcs/known-issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">RSP documentation</li>
                                                                                                                                                        
      <li>
  
                          <a href="../../rsp/integration/integration.html" title="Integration">
          <span class="icon-chevron-right"></span>
        Integration</a>
                  </li>
                                                                                                                                                                                              
      <li>
  
                          <a href="../../rsp/configuration/configuration.html" title="Configuration">
          <span class="icon-chevron-down"></span>
        Configuration</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../../rsp/configuration/rsp_config.html" title="RSP Configuration">
          <span class="none"></span>
        RSP Configuration</a>
            </li>
                    
      <li>
  
                          <a href="../../rsp/configuration/cep_config.html" title="CEP Configuration">
          <span class="none"></span>
        CEP Configuration</a>
            </li>
                                                                                        
      <li>
  
                          <a href="../../rsp/configuration/customization.html" title="Customization">
          <span class="icon-chevron-right"></span>
        Customization</a>
                  </li>
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>Housekeeping</a>
          </li>
                    
      <li>
  
                          <a href="../../rsp/configuration/tomcat_configuration.html" title="Tomcat configuration">
          <span class="none"></span>
        Tomcat configuration</a>
            </li>
              </ul>
        </li>
                              <li class="nav-header">MI documentation</li>
                              
      <li>
  
                          <a href="../../mi/installation/app-queue.html" title="AppQueue Installation">
          <span class="none"></span>
        AppQueue Installation</a>
            </li>
                                                                                    
      <li>
  
                          <a href="../../mi/index.html" title="Data export">
          <span class="icon-chevron-right"></span>
        Data export</a>
                  </li>
                              <li class="nav-header">3PS documentation</li>
                              
      <li>
  
                          <a href="../../tps/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                                        
      <li>
  
                          <a href="../../tps/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../tps/api.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                              <li class="nav-header">UWB documentation</li>
                              
      <li>
  
                          <a href="../../uwb/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                  
      <li>
  
                          <a href="../../uwb/installation/index.html" title="Installation">
          <span class="icon-chevron-right"></span>
        Installation</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../uwb/configuration/application/index.html" title="Application Configuration">
          <span class="icon-chevron-right"></span>
        Application Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../uwb/configuration/office/index.html" title="Office Configuration">
          <span class="icon-chevron-right"></span>
        Office Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../uwb/features/index.html" title="Advanced Features">
          <span class="icon-chevron-right"></span>
        Advanced Features</a>
                  </li>
                                                                  
      <li>
  
                          <a href="../../uwb/operations/index.html" title="Operations">
          <span class="icon-chevron-right"></span>
        Operations</a>
                  </li>
                
      <li>
  
                          <a href="../../uwb/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">MIGRATION documentation</li>
                              
      <li>
  
                          <a href="../../migration/index.html" title="User Guide">
          <span class="none"></span>
        User Guide</a>
            </li>
                              <li class="nav-header">Appendix</li>
                              
      <li>
  
                          <a href="../../glossary.html" title="Glossary">
          <span class="none"></span>
        Glossary</a>
            </li>
                
      <li>
  
                          <a href="../../component-versions.html" title="Component Versions">
          <span class="none"></span>
        Component Versions</a>
            </li>
                                                                                                                                          
      <li>
  
                          <a href="../../release-migration-notes.html" title="Release And Migration Notes">
          <span class="icon-chevron-right"></span>
        Release And Migration Notes</a>
                  </li>
                
      <li>
  
                          <a href="../../changelog.html" title="Changelog">
          <span class="none"></span>
        Changelog</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Housekeeping</h1>
<p>To clean up old data, the RSP offers an API to delete processed and abandoned assessments. A cleanup will affect the stored data inside the RSP as well inside the CEP.</p>
<p>On top of the API, the RSP offers a scheduled execution of the housekeeping. Therefore the startup time, the frequency of the execution and the expiration time for processed and abandoned assessments are configurable.</p><section>
<h2><a name="Cleaned_Up_Data"></a>Cleaned Up Data</h2>
<p>For the following data the RSP housekeeping is taking place:</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th> Component </th>
<th> Table                    </th>
<th> Description of Housekeeping Activity                                                                                                         </th></tr>
</thead><tbody>

<tr class="b">
<td> RSP       </td>
<td> UserContext              </td>
<td> Entries that have relations to one or more pending or processed assessments won&#x2019;t clean up.                          </td></tr>
<tr class="a">
<td> RSP       </td>
<td> AssessmentWrapper        </td>
<td> All assessments that are processed or not finished after a certain period of time will be cleaned up.               </td></tr>
<tr class="b">
<td> CEP       </td>
<td> activeRiskAssessments    </td>
<td> Connected active risk assessments will be deleted automatically when processed or abandoned entries are cleaned up. </td></tr>
<tr class="a">
<td> CEP       </td>
<td> suspendedRiskAssessments </td>
<td> No usage at the moment inside the RSP.                                                                              </td></tr>
</tbody>
</table></section><section>
<h2><a name="Configuration_of_the_Scheduled_Housekeeping"></a>Configuration of the Scheduled Housekeeping</h2>
<p>On application start up the housekeeping will be scheduled as configured. The repetition interval for the housekeeping is configurable. The configuration file can be found under <code>$REFLEX_CONFIG_ROOTDIR/rsp/config.properties</code>.</p>
<p>In case the scheduled housekeeping doesn&#x2019;t fit the special needs, it can be deactivated and an individual clean up of the data has to be set up by the integrator. The API offers two methods to clean up data that are explained in the section <i>&#x201c;The housekeeping API&#x201d;</i> below.</p><section>
<h3><a name="Configure_Activation.2C_Start_Up_Time_and_Repetition_Interval"></a>Configure Activation, Start Up Time and Repetition Interval</h3>
<p>After the application is started the housekeeping job is created in case the property <code>com.hannoverre.reflex.rsp.housekeeping.housekeepingActive</code> is set to <code>true</code>. The hour and the minute of the first execution and the time repetition interval minutes for the following executions are configurable:</p>
<p>For instance, if the startup time of the application is 08:00 a.m. and the configured start hour is 6, the housekeeping job will start the next day 06:00 a.m.</p>

<div class="source">
<div class="source"><pre class="prettyprint"># Activates the scheduled housekeeping (true, false), the default is false if commented out/removed.
com.hannoverre.reflex.rsp.housekeeping.housekeepingActive=true

# Starting hour for the scheduled housekeeping. Defaults to 0 (i.e. 12 a.m.) if commented out/removed.
com.hannoverre.reflex.rsp.housekeeping.startHour=6

# Starting minute for the scheduled housekeeping. Defaults to 0 if commented out/removed.
com.hannoverre.reflex.rsp.housekeeping.startMinute=0

# Repetition interval for scheduled housekeeping in minutes, greater or equals 1. Defaults to 1 440 (i.e. once every day) if commented out/removed.
com.hannoverre.reflex.rsp.housekeeping.repetitionIntervalMinutes=1440
</pre></div></div>
</section><section>
<h3><a name="Configure_Period_of_Time_Until_Cleaning_Up_Data"></a>Configure Period of Time Until Cleaning Up Data</h3>
<p>In the configuration example below the unfinished assessments will be cleaned up after 16 hours and processed assessments are kept until 120 hours after the last edit was done.</p>

<div class="source">
<div class="source"><pre class="prettyprint"># The number of hours that an assessment in any state at least is stored until the housekeeping will clean up the data.
com.hannoverre.reflex.rsp.housekeeping.cleanUpAbandonedAssessmentsAfterHours=16

# The number of hours that an processed assessment at least is stored until the housekeeping will clean up the data.
com.hannoverre.reflex.rsp.housekeeping.cleanUpProcessedAssessmentsAfterHours=120

# The number of days that a user context without any assessment at least is stored until the housekeeping will clean up the data.
com.hannoverre.reflex.rsp.housekeeping.cleanUpUsersAfterDays=14
</pre></div></div>
</section><section>
<h3><a name="Example_of_Data_Clean_Up"></a>Example of Data Clean Up</h3>
<p>Assume the following example configuration for the housekeeping:</p>

<div class="source">
<div class="source"><pre class="prettyprint">com.hannoverre.reflex.rsp.housekeeping.cleanUpAbandonedAssessmentsAfterHours=14
com.hannoverre.reflex.rsp.housekeeping.cleanUpProcessedAssessmentsAfterHours=120
com.hannoverre.reflex.rsp.housekeeping.cleanUpUsersAfterDays=90
com.hannoverre.reflex.rsp.housekeeping.repetitionIntervalMinutes=15
com.hannoverre.reflex.rsp.housekeeping.startHour=10
com.hannoverre.reflex.rsp.housekeeping.startMinute=0
</pre></div></div>

<p>The housekeeping is configured to start the first execution at 10 a.m. and to repeat the execution every 15 minutes. The server startup was  17th January, 2019 9:00 a.m.</p>
<p>The current date and time is February 1st, 2019 10:00 a.m.</p>
<p>Based on the setting above the scheduled housekeeping will look for assessments last modified before 2019-01-18 and assessments with the state processed last modified before 2019-02-01 08:00 a.m.</p>
<p>RSP User Context: Row 5 and 7 will be deleted</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th> id </th>
<th> consented           </th>
<th> currentState </th></tr>
</thead><tbody>

<tr class="b">
<td> 1  </td>
<td> 2019-01-17 09:45:00 </td>
<td> CONSENTED    </td></tr>
<tr class="a">
<td> 2  </td>
<td> 2019-01-17 10:00:00 </td>
<td> CONSENTED    </td></tr>
<tr class="b">
<td> 3  </td>
<td> 2019-02-01 07:45:00 </td>
<td> CONSENTED    </td></tr>
<tr class="a">
<td> 4  </td>
<td> 2019-02-01 07:45:00 </td>
<td> CONSENTED    </td></tr>
<tr class="b">
<td> 5  </td>
<td> 2019-01-10 9:45:00  </td>
<td> CREATED      </td></tr>
<tr class="a">
<td> 6  </td>
<td> 2019-01-11 7:45:00  </td>
<td> CREATED      </td></tr>
<tr class="b">
<td> 7  </td>
<td> 2019-01-10 9:45:00  </td>
<td> CONSENTED    </td></tr>
<tr class="a">
<td> 8  </td>
<td> 2019-01-11 7:45:00  </td>
<td> CONSENTED    </td></tr>
</tbody>
</table>
<p>RSP Assessment Wrapper: Row 1 and 4 will be deleted</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th> id </th>
<th> assessmentId                         </th>
<th> created             </th>
<th> lastModified        </th>
<th> currentState </th>
<th> userContextId </th></tr>
</thead><tbody>

<tr class="b">
<td> 1  </td>
<td> 1&#x2026;&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;&#x2026;&#x2026;..1 </td>
<td> 2019-01-17 09:45:00 </td>
<td> 2019-01-17 09:45:00 </td>
<td> STARTED      </td>
<td> 1              </td></tr>
<tr class="a">
<td> 2  </td>
<td> 2&#x2026;&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;&#x2026;&#x2026;..2 </td>
<td> 2019-01-18 09:45:00 </td>
<td> 2019-01-18 09:50:00 </td>
<td> STARTED      </td>
<td> 2              </td></tr>
<tr class="b">
<td> 3  </td>
<td> 3&#x2026;&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;&#x2026;&#x2026;..3 </td>
<td> 2019-02-01 07:46:00 </td>
<td> 2019-02-01 07:59:00 </td>
<td> COMPLETED    </td>
<td> 3              </td></tr>
<tr class="a">
<td> 4  </td>
<td> 4&#x2026;&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;&#x2026;&#x2026;..4 </td>
<td> 2019-02-01 07:46:00 </td>
<td> 2019-02-01 07:59:00 </td>
<td> PROCESSED    </td>
<td> 4              </td></tr>
</tbody>
</table>
<p>CEP ActiveRiskAssessment: Row 1 and 4 will be deleted</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th> id                                   </th>
<th> document            </th></tr>
</thead><tbody>

<tr class="b">
<td> 1&#x2026;&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;&#x2026;&#x2026;..1 </td>
<td> {JSON document &#x2026;} </td></tr>
<tr class="a">
<td> 2&#x2026;&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;&#x2026;&#x2026;..2 </td>
<td> {JSON document &#x2026;} </td></tr>
<tr class="b">
<td> 3&#x2026;&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;&#x2026;&#x2026;..3 </td>
<td> {JSON document &#x2026;} </td></tr>
<tr class="a">
<td> 4&#x2026;&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;.-&#x2026;&#x2026;&#x2026;..4 </td>
<td> {JSON document &#x2026;} </td></tr>
</tbody>
</table></section></section>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2020.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
