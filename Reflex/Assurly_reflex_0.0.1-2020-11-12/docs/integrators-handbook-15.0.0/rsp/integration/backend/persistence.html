<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 at 2020-09-25 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20200925" />
    <meta http-equiv="Content-Language" content="en" />
    <title>ReFlex ReFlex Integrator's Handbook &#x2013; RSP Back End Persistence</title>
    <link rel="stylesheet" href="../../../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../../../css/site.css" />
    <link rel="stylesheet" href="../../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../../js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://www.hannover-re.com/" id="bannerLeft">
                                                                                                <img src="../../../images/logo.svg"  alt="HannoverRe"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="https://www.hannover-re.com/" id="bannerRight">
                                                                                                <img src="../../../images/hre-logo.svg"  alt="HannoverRe_log"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="projectVersion">Version: 15.0.0
                    </li>
              
              
                  <li id="publishDate" class="pull-right">Last Published: 2020-09-25</li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                          
      <li>
  
                          <a href="../../../index.html" title="Document Information">
          <span class="none"></span>
        Document Information</a>
            </li>
                                                                                                                                                            
      <li>
  
                          <a href="../../../reflex-overview/index.html" title="ReFlex Overview">
          <span class="icon-chevron-right"></span>
        ReFlex Overview</a>
                  </li>
                
      <li>
  
                          <a href="../../../installation-guide.html" title="Installation Guide">
          <span class="none"></span>
        Installation Guide</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../../update-guide/index.html" title="Update Guide">
          <span class="icon-chevron-right"></span>
        Update Guide</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../../use-cases/index.html" title="Use Cases">
          <span class="icon-chevron-right"></span>
        Use Cases</a>
                  </li>
                              <li class="nav-header">RAS documentation</li>
                              
      <li>
  
                          <a href="../../../ras/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../../ras/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                                      
      <li>
  
                          <a href="../../../ras/general-notes/index.html" title="General Notes">
          <span class="icon-chevron-right"></span>
        General Notes</a>
                  </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="../../../ras/rest-resources/index.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                                                                                                                                                                                                                                                      
      <li>
  
                          <a href="../../../ras/usage-scenarios/index.html" title="Usage Scenarios">
          <span class="icon-chevron-right"></span>
        Usage Scenarios</a>
                  </li>
                                                                                                                                          
      <li>
  
                          <a href="../../../ras/known-issues/index.html" title="Known Issues">
          <span class="icon-chevron-right"></span>
        Known Issues</a>
                  </li>
                              <li class="nav-header">CEP documentation</li>
                              
      <li>
  
                          <a href="../../../cep/integration/integration_mechanism.html" title="Integration Mechanism">
          <span class="none"></span>
        Integration Mechanism</a>
            </li>
                                                                                                                                                                                          
      <li>
  
                          <a href="../../../cep/integration/backend/index.html" title="Back End Integration">
          <span class="icon-chevron-right"></span>
        Back End Integration</a>
                  </li>
                                                                                                                                                                                                                        
      <li>
  
                          <a href="../../../cep/integration/frontend/index.html" title="Front End Integration">
          <span class="icon-chevron-right"></span>
        Front End Integration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../../cep/integration/features/index.html" title="Optional Features">
          <span class="icon-chevron-right"></span>
        Optional Features</a>
                  </li>
                                                                                                                              
      <li>
  
                          <a href="../../../cep/integration/operations/index.html" title="Operations">
          <span class="icon-chevron-right"></span>
        Operations</a>
                  </li>
                
      <li>
  
                          <a href="../../../cep/integration/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">DCS documentation</li>
                              
      <li>
  
                          <a href="../../../dcs/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                
      <li>
  
                          <a href="../../../dcs/configuration.html" title="Configuration">
          <span class="none"></span>
        Configuration</a>
            </li>
                
      <li>
  
                          <a href="../../../dcs/rest-api.html" title="REST API">
          <span class="none"></span>
        REST API</a>
            </li>
                                                                                                      
      <li>
  
                          <a href="../../../dcs/template-config/template-configuration.html" title="Template Configuration">
          <span class="icon-chevron-right"></span>
        Template Configuration</a>
                  </li>
                
      <li>
  
                          <a href="../../../dcs/known-issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">RSP documentation</li>
                                                                                                                                                                  
      <li>
  
                          <a href="../../../rsp/integration/integration.html" title="Integration">
          <span class="icon-chevron-down"></span>
        Integration</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../../../rsp/integration/internal_external.html" title="Internal prepare vs external prepare">
          <span class="none"></span>
        Internal prepare vs external prepare</a>
            </li>
                    
      <li>
  
                          <a href="../../../rsp/interfaces/authentication-interface.html" title="Authentication, e-Signing and Logout">
          <span class="none"></span>
        Authentication, e-Signing and Logout</a>
            </li>
                    
      <li>
  
                          <a href="../../../rsp/interfaces/output-interface.html" title="Output">
          <span class="none"></span>
        Output</a>
            </li>
                    
      <li>
  
                          <a href="../../../rsp/integration/backend/housekeepingAPI.html" title="Housekeeping API">
          <span class="none"></span>
        Housekeeping API</a>
            </li>
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>Persistence</a>
          </li>
              </ul>
        </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../../rsp/configuration/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                              <li class="nav-header">MI documentation</li>
                              
      <li>
  
                          <a href="../../../mi/installation/app-queue.html" title="AppQueue Installation">
          <span class="none"></span>
        AppQueue Installation</a>
            </li>
                                                                                    
      <li>
  
                          <a href="../../../mi/index.html" title="Data export">
          <span class="icon-chevron-right"></span>
        Data export</a>
                  </li>
                              <li class="nav-header">3PS documentation</li>
                              
      <li>
  
                          <a href="../../../tps/overview.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                                                                        
      <li>
  
                          <a href="../../../tps/configuration.html" title="Configuration">
          <span class="icon-chevron-right"></span>
        Configuration</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="../../../tps/api.html" title="REST API">
          <span class="icon-chevron-right"></span>
        REST API</a>
                  </li>
                              <li class="nav-header">UWB documentation</li>
                              
      <li>
  
                          <a href="../../../uwb/index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                                                                  
      <li>
  
                          <a href="../../../uwb/installation/index.html" title="Installation">
          <span class="icon-chevron-right"></span>
        Installation</a>
                  </li>
                                                                                                                        
      <li>
  
                          <a href="../../../uwb/configuration/application/index.html" title="Application Configuration">
          <span class="icon-chevron-right"></span>
        Application Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../../uwb/configuration/office/index.html" title="Office Configuration">
          <span class="icon-chevron-right"></span>
        Office Configuration</a>
                  </li>
                                                                                                                                                                                    
      <li>
  
                          <a href="../../../uwb/features/index.html" title="Advanced Features">
          <span class="icon-chevron-right"></span>
        Advanced Features</a>
                  </li>
                                                                  
      <li>
  
                          <a href="../../../uwb/operations/index.html" title="Operations">
          <span class="icon-chevron-right"></span>
        Operations</a>
                  </li>
                
      <li>
  
                          <a href="../../../uwb/known_issues.html" title="Known Issues">
          <span class="none"></span>
        Known Issues</a>
            </li>
                              <li class="nav-header">MIGRATION documentation</li>
                              
      <li>
  
                          <a href="../../../migration/index.html" title="User Guide">
          <span class="none"></span>
        User Guide</a>
            </li>
                              <li class="nav-header">Appendix</li>
                              
      <li>
  
                          <a href="../../../glossary.html" title="Glossary">
          <span class="none"></span>
        Glossary</a>
            </li>
                
      <li>
  
                          <a href="../../../component-versions.html" title="Component Versions">
          <span class="none"></span>
        Component Versions</a>
            </li>
                                                                                                                                          
      <li>
  
                          <a href="../../../release-migration-notes.html" title="Release And Migration Notes">
          <span class="icon-chevron-right"></span>
        Release And Migration Notes</a>
                  </li>
                
      <li>
  
                          <a href="../../../changelog.html" title="Changelog">
          <span class="none"></span>
        Changelog</a>
            </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../../../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>RSP Back End Persistence</h1>
<p>CEP and RSP components are storing their working data in a persistence storage. For instance the CEP is storing the active risk assessment as a working data to communicate with the RAS component. The RSP is storing the state of the assessment and the user context.</p>
<p>As a persistence storage for both components a volatile memory or a durable storage medium can be chosen. A volatile memory storage is not designed for permanent storage and all data is lost if the hardware is switched off. Nevertheless whether a volatile or a durable memory storage is used a clean up of the working data can be necessary. Therefore the RSP provide a built-in housekeeping to clean completed or abandoned assessments.</p>
<p>This chapter explains the data that is stored by the RSP and the CEP components and how the housekeeping can be configured.</p><section>
<h2><a name="Stored_Data"></a>Stored Data</h2>
<p>The data storage for the CEP and RSP component are configured separately. While CEP can use Hazelcast or JDBC data sources, RSP use JDBC data sources only.</p><section>
<h3><a name="RSP"></a>RSP</h3>
<p>Only contextual information about the user and the assessment are stored by the RSP. While the assessment data like questions and given answers will only be stored from the CEP component in the configured persistence storage.</p><section>
<h4><a name="User_Context"></a>User Context</h4>
<p>Information such as partner and tracking id or if the user accepted the agreement on the consent page are stored in the user context.</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th> Stored Data           </th>
<th> Description   </th></tr>
</thead><tbody>

<tr class="b">
<td> Assessment base data  </td>
<td> Used data block to prepare the user context.</td></tr>
<tr class="a">
<td> Consented             </td>
<td> The timestamp on which the user accepted the agreement on the consent page.</td></tr>
<tr class="b">
<td> Logged-in message     </td>
<td> The message that is displayed once a user is authenticated and logged in to the RSP.</td></tr>
<tr class="a">
<td> partner id            </td>
<td> The partner id identifies different partners in the system.</td></tr>
<tr class="b">
<td> current state         </td>
<td> The process state of the user context: CREATED, CONSENTED</td></tr>
<tr class="a">
<td> tracking id           </td>
<td> The tracking id is a key to a specific user.</td></tr>
</tbody>
</table></section><section>
<h4><a name="Assessment_Wrapper"></a>Assessment Wrapper</h4>
<p>To store the state of the assessment or to continue the assessment the RSP is storing the state and the assessment id in the assessment wrapper. Also the created PDF after the assessment is processed is stored in this data table.</p>
<p>The assessment wrapper is storing the state of the assessment and the assessment id so that the assessment can be loaded from the CEP component.</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th> Stored Data   </th>
<th> Description   </th></tr>
</thead><tbody>

<tr class="b">
<td> Assessment language   </td>
<td> The language code of the assessment.</td></tr>
<tr class="a">
<td> confirmed             </td>
<td> Timestamp on which the assessment was confirmed.</td></tr>
<tr class="b">
<td> created               </td>
<td> Timestamp on which the assessment was created.</td></tr>
<tr class="a">
<td> Direct URL            </td>
<td> URL that points to assessment.</td></tr>
<tr class="b">
<td> Last modified         </td>
<td> Timestamp when the assessment was modified.</td></tr>
<tr class="a">
<td> PDF                   </td>
<td> The created PDF file that was created after the the assessment was completed.</td></tr>
<tr class="b">
<td> Prepared data         </td>
<td> Used data block to prepare the assessment.</td></tr>
<tr class="a">
<td> Current state         </td>
<td> The process state of the assessment: <i>PREPARED, STARTED, COMPLETED, PROCESSED</i></td></tr>
</tbody>
</table></section><section>
<h4><a name="RSP_Data_Source_Configuration"></a>RSP Data Source Configuration</h4>
<p>This section demonstrates the RSP data source configuration with an example configuration of the RSP with the in-memory database &#x201c;H2&#x201d; (used version 1.4.200). Note that RSP is not bundling JDBC drivers and you have to provide the appropriate JDBC driver for your database in the RSP web application accessible classpath, for example by placing the driver jar(s) in the <code>&lt;tomcat_home&gt;/lib</code> directory.</p>
<p>For more information about the configuration of the CEP please check the integrators handbook of the CEP.</p>

<div class="source">
<div class="source"><pre class="prettyprint"># Persistence Configuration
com.hannoverre.reflex.rsp.datasource.url=jdbc:h2:mem:rsp;DB_CLOSE_DELAY=-1
com.hannoverre.reflex.rsp.datasource.driver=org.h2.Driver
com.hannoverre.reflex.rsp.datasource.username=username
com.hannoverre.reflex.rsp.datasource.password=password

com.hannoverre.reflex.rsp.hibernate.dialect=org.hibernate.dialect.H2Dialect
com.hannoverre.reflex.rsp.hibernate.show_sql=false
com.hannoverre.reflex.rsp.hibernate.hbm2ddl.auto=update
</pre></div></div>
</section></section><section>
<h3><a name="CEP"></a>CEP</h3><section>
<h4><a name="Active_Risk_Assessments"></a>Active Risk Assessments</h4>
<p>To operate the questionnaire between the CEP and the RAS the CEP is storing the current state of risk assessment in the data storage. If inside the RSP the assessment has to be continued, the assessment will be restored with the assessment that is stored in this table. Every auto submit from the CEP stores the current state of the assessment here.</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th> Stored Data </th>
<th> Description </th></tr>
</thead><tbody>

<tr class="b">
<td> Assessment </td>
<td> The current state of the active assessment. (JSON)</td></tr>
</tbody>
</table></section><section>
<h4><a name="Suspended_Risk_Assessments"></a>Suspended Risk Assessments</h4>
<p>At the moment the suspend and resume functionality isn&#x2019;t used by the RSP.</p></section></section></section><section>
<h2><a name="When_Data_is_Persisted"></a>When Data is Persisted</h2>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th> page / step </th>
<th>	RSP </th>
<th> CEP </th></tr>
</thead><tbody>

<tr class="b">
<td> login / authentication page </td>
<td>	user context: <i>created</i> </td>
<td> - </td></tr>
<tr class="a">
<td> consent page </td>
<td> user context: <i>consented</i> </td>
<td> - </td></tr>
<tr class="b">
<td> product selection	</td>
<td> assessment wrapper: <i>prepared</i> </td>
<td> - </td></tr>
<tr class="a">
<td> start assessment  </td>
<td> assessment wrapper: <i>started</i> </td>
<td> current state of active risk assessment </td></tr>
<tr class="b">
<td> fill out assessment </td>
<td> - </td>
<td> auto save of the active risk assessment (1) </td></tr>
<tr class="a">
<td> submit assessment </td>
<td> assessment wrapper: <i>completed</i> </td>
<td> state of active risk assessment </td></tr>
<tr class="b">
<td> confirm assessment </td>
<td> assessment wrapper: <i>processed</i> </td>
<td> state of active risk assessment </td></tr>
</tbody>
</table>
<p><i>(1) The auto save of the CEP can be configured in a way, that every second, or any other frequency, the CEP check for changes on the given answers and store the current state in the active risk assessment in the configured data storage.</i></p></section>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2020.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
